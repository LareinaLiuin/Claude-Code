<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡”ç½—ç‰Œæµ‹ç®— - æ¢ç´¢å†…å¿ƒçš„æ™ºæ…§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .title {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            color: #b8b8b8;
            margin-bottom: 30px;
        }

        /* é¡µé¢åˆ‡æ¢ */
        .page {
            display: none;
            animation: fadeIn 0.8s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* é—®é¢˜ç±»å‹é€‰æ‹©é¡µé¢ */
        .question-type-selection {
            text-align: center;
            margin-top: 30px;
            width: 100%;
        }

        .question-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px;
            margin: 50px 0;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .category-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
            transition: left 0.5s;
        }

        .category-card:hover::before {
            left: 100%;
        }

        .category-card:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.5);
            transform: translateY(-5px);
        }

        .category-card.selected {
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
        }

        .category-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .category-name {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .category-description {
            color: #b8b8b8;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* å…·ä½“é—®é¢˜è¾“å…¥é¡µé¢ */
        .question-input {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            margin-top: 30px;
            text-align: center;
        }

        .question-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 30px;
            text-align: left;
        }

        .form-group label {
            display: block;
            color: #ffd700;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1.1rem;
            resize: vertical;
            min-height: 120px;
            transition: all 0.3s ease;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .form-group textarea::placeholder {
            color: #888;
        }

        /* ç‰Œé˜µé€‰æ‹©é¡µé¢ */
        .spread-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .spread-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.3);
            cursor: pointer;
            position: relative;
        }

        .spread-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.6);
        }

        .spread-card.recommended {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .spread-card.recommended::before {
            content: 'â­ æ¨è';
            position: absolute;
            top: 10px;
            right: 15px;
            background: #ffd700;
            color: #1a1a2e;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .spread-image {
            width: 100%;
            height: 180px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
        }

        .spread-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
            border-radius: 10px;
            filter: brightness(0.8) contrast(1.1);
        }

        .spread-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.3) 0%, rgba(15, 52, 96, 0.4) 100%);
            border-radius: 10px;
            z-index: 1;
        }

        .spread-card:hover .spread-image img {
            transform: scale(1.05);
            filter: brightness(0.9) contrast(1.2);
        }

        .spread-name {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .spread-description {
            color: #b8b8b8;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .spread-info {
            font-size: 0.9rem;
            color: #888;
        }

        /* æŠ½ç‰Œé¡µé¢ */
        .tarot-reading-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            margin-top: 30px;
            text-align: center;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .spread-layout {
            position: relative;
            min-height: 500px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin: 30px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            max-width: 600px;
            width: 100%;
        }

        .card-slot {
            position: absolute;
            width: 80px;
            height: 120px;
            background: rgba(255, 215, 0, 0.1);
            border: 2px dashed rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
        }

        .card-slot:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.6);
        }

        .card-slot.filled {
            border: 2px solid #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        /* å•å¼ ç‰Œçš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.one-card .card-slot {
            width: 150px;
            height: 225px;
            font-size: 4rem;
        }

        .spread-layout.one-card .tarot-card {
            width: 150px;
            height: 225px;
            font-size: 3rem;
        }

        /* ä¸‰å¼ ç‰Œç‰Œé˜µçš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.three-cards .card-slot {
            width: 120px;
            height: 180px;
            font-size: 3rem;
        }

        .spread-layout.three-cards .tarot-card {
            width: 120px;
            height: 180px;
            font-size: 2rem;
        }

        /* äº”å¼ ç‰Œåå­—çš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.five-cross .card-slot {
            width: 90px;
            height: 135px;
            font-size: 2rem;
        }

        .spread-layout.five-cross .tarot-card {
            width: 90px;
            height: 135px;
            font-size: 1.5rem;
        }

        /* æ˜Ÿå…‰ç‰Œé˜µçš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.star-spread .card-slot {
            width: 90px;
            height: 135px;
            border-radius: 50%;
            border: 2px dashed rgba(255, 215, 0, 0.5);
        }

        .spread-layout.star-spread .tarot-card {
            width: 90px;
            height: 135px;
            font-size: 1.2rem;
            border-radius: 6px;
        }

        /* é©¬è¹„å½¢ç‰Œé˜µçš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.horseshoe-layout .card-slot {
            width: 80px;
            height: 120px;
            font-size: 1.5rem;
        }

        .spread-layout.horseshoe-layout .tarot-card {
            width: 80px;
            height: 120px;
            font-size: 1.2rem;
        }

        /* å…³ç³»ç‰Œé˜µçš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.relationship-layout .card-slot {
            width: 85px;
            height: 130px;
            border-radius: 10px;
            font-size: 1.5rem;
        }

        .spread-layout.relationship-layout .tarot-card {
            width: 85px;
            height: 130px;
            font-size: 1.2rem;
            border-radius: 8px;
        }

        /* å‡¯å°”ç‰¹åå­—ç‰Œé˜µçš„ç‰¹æ®Šæ ·å¼ */
        .spread-layout.celtic-cross .card-slot {
            width: 70px;
            height: 105px;
            font-size: 1.5rem;
        }

        .spread-layout.celtic-cross .tarot-card {
            width: 70px;
            height: 105px;
            font-size: 1rem;
        }

        .draw-button {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        .draw-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
        }

        .draw-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* å¡”ç½—ç‰Œæ ·å¼ */
        .tarot-card {
            width: 80px;
            height: 120px;
            background: linear-gradient(135deg, #2c2c54, #40407a);
            border-radius: 8px;
            border: 2px solid #ffd700;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #ffd700;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            animation: cardAppear 0.6s ease-out;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: scale(0.5) rotateY(180deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotateY(0deg);
            }
        }

        .tarot-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        .tarot-card.reversed {
            transform: rotate(180deg);
        }

        .overlapping-card {
            position: absolute !important;
            top: 3px !important;
            left: 3px !important;
            z-index: 10 !important;
        }

        .card-name {
            font-size: 0.8rem;
            margin-top: 5px;
            text-align: center;
            color: #ffd700;
        }

        /* é—®é¢˜å›é¡¾ */
        .question-review {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 4px solid #ffd700;
        }

        .question-review h3 {
            color: #ffd700;
            margin-bottom: 10px;
        }

        .question-review p {
            color: #fff;
            line-height: 1.6;
        }

        /* è§£è¯»ç»“æœ */
        .reading-results {
            margin-top: 30px;
            text-align: left;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid #ffd700;
        }

        .result-position {
            font-size: 1.3rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 15px;
        }

        .result-card-info {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .result-card-image {
            width: 80px;
            height: 120px;
            background: linear-gradient(135deg, #2c2c54, #40407a);
            border-radius: 8px;
            margin-right: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: #ffd700;
            flex-shrink: 0;
        }

        .result-card-details h4 {
            color: #ffd700;
            margin-bottom: 8px;
            font-size: 1.2rem;
        }

        .result-card-details p {
            color: #b8b8b8;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .result-interpretation {
            color: #fff;
            line-height: 1.8;
            font-size: 1.1rem;
            text-align: justify;
        }

        .overall-analysis {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 15px;
            padding: 35px;
            margin-top: 40px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .overall-analysis h3 {
            color: #ffd700;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.5rem;
        }

        .overall-analysis p {
            color: #fff;
            line-height: 1.8;
            font-size: 1.1rem;
            text-align: justify;
            margin-bottom: 20px;
        }

        /* æŒ‰é’®æ ·å¼ */
        .button-group {
            text-align: center;
            margin-top: 40px;
        }

        .btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border: none;
            padding: 15px 35px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: #ffd700;
            border: 2px solid #ffd700;
        }

        .btn-secondary:hover {
            background: rgba(255, 215, 0, 0.1);
        }

        .btn-large {
            padding: 18px 45px;
            font-size: 1.2rem;
        }

        .btn-skip {
            background: rgba(255, 255, 255, 0.1);
            color: #ccc;
            border: 2px solid #666;
            padding: 15px 30px;
            font-size: 1rem;
        }

        .btn-skip:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border-color: #999;
        }

        /* è¿›åº¦æŒ‡ç¤ºå™¨ */
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .progress-info {
            text-align: center;
            color: #b8b8b8;
            margin-bottom: 20px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }

            .spread-selection {
                grid-template-columns: 1fr;
            }

            .question-categories {
                grid-template-columns: 1fr;
                gap: 20px;
                max-width: 400px;
                margin-left: auto;
                margin-right: auto;
            }

            .category-card {
                padding: 20px;
            }

            .category-icon {
                font-size: 3rem;
            }

            .category-name {
                font-size: 1.3rem;
            }

            .tarot-reading-area {
                padding: 20px;
                max-width: 100%;
                margin-left: 15px;
                margin-right: 15px;
            }

            .spread-layout {
                max-width: 100%;
                min-height: 350px;
            }

            .result-card-info {
                flex-direction: column;
                text-align: center;
            }

            .result-card-image {
                margin: 0 auto 15px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            .question-categories {
                grid-template-columns: 1fr;
                gap: 15px;
                max-width: 300px;
            }

            .category-card {
                padding: 15px;
            }

            .category-icon {
                font-size: 2.5rem;
            }

            .category-name {
                font-size: 1.2rem;
            }

            .category-description {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
    <div class="stars" id="stars"></div>

    <div class="container">
        <header class="header">
            <h1 class="title">å¡”ç½—ç‰Œæµ‹ç®—</h1>
            <p class="subtitle">æ¢ç´¢å†…å¿ƒçš„æ™ºæ…§ï¼Œæ‰¾åˆ°ç”Ÿæ´»çš„ç­”æ¡ˆ</p>
        </header>

        <!-- é—®é¢˜ç±»å‹é€‰æ‹©é¡µé¢ -->
        <div id="question-type-page" class="page active">
            <div class="question-type-selection">
                <h2 style="text-align: center; margin-bottom: 50px; color: #ffd700; font-size: 2rem;">
                    è¯·é€‰æ‹©ä½ æƒ³è¦å’¨è¯¢çš„é¢†åŸŸ
                </h2>
                <div class="question-categories" id="question-categories" style="min-height: 200px;">
                    <!-- é—®é¢˜åˆ†ç±»å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    <div style="color: #888; text-align: center; padding: 40px;">æ­£åœ¨åŠ è½½é—®é¢˜åˆ†ç±»...</div>
                </div>
            </div>
        </div>

        <!-- å…·ä½“é—®é¢˜è¾“å…¥é¡µé¢ -->
        <div id="question-input-page" class="page">
            <div class="question-input">
                <h2 style="color: #ffd700; margin-bottom: 30px; font-size: 2rem;">å‘Šè¯‰æˆ‘ä½ çš„é—®é¢˜</h2>
                <div class="question-form">
                    <div class="form-group">
                        <label for="user-question">
                            è¯·è¯¦ç»†æè¿°ä½ æƒ³è¦å åœçš„é—®é¢˜æˆ–å›°æƒ‘ï¼š
                        </label>
                        <textarea
                            id="user-question"
                            placeholder="ä¾‹å¦‚ï¼šæˆ‘æœ€è¿‘åœ¨èŒä¸šå‘å±•ä¸Šæ„Ÿåˆ°è¿·èŒ«ï¼Œä¸çŸ¥é“æ˜¯å¦åº”è¯¥æ¢å·¥ä½œ..."
                            rows="6"
                        ></textarea>
                    </div>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="backToQuestionType()">è¿”å›</button>
                        <button class="btn btn-skip" onclick="skipToSpreadSelection()">è·³è¿‡å¡«å†™</button>
                        <button class="btn btn-large" onclick="proceedToSpreadSelection()">ä¸‹ä¸€æ­¥ï¼šé€‰æ‹©ç‰Œé˜µ</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç‰Œé˜µé€‰æ‹©é¡µé¢ -->
        <div id="spread-selection-page" class="page">
            <div class="question-review" id="question-review">
                <!-- é—®é¢˜å›é¡¾å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <h2 style="text-align: center; margin-bottom: 30px; color: #ffd700; font-size: 2rem;">
                é€‰æ‹©é€‚åˆçš„ç‰Œé˜µ
            </h2>
            <div class="spread-selection" id="spread-selection">
                <!-- ç‰Œé˜µé€‰é¡¹å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æŠ½ç‰Œé¡µé¢ -->
        <div id="reading-page" class="page">
            <div class="tarot-reading-area">
                <h2 id="spread-title" style="color: #ffd700; margin-bottom: 20px;"></h2>
                <p id="spread-description" style="color: #b8b8b8; margin-bottom: 30px;"></p>

                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-info" id="progress-info"></div>

                <div class="spread-layout" id="spread-layout">
                    <!-- ç‰Œé˜µå¸ƒå±€å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>

                <button class="draw-button" id="draw-card-btn" onclick="drawCard()">æŠ½å–å¡ç‰Œ</button>
                <button class="draw-button" id="complete-reading-btn" onclick="proceedToQuestionCategory()" style="display: none;">å®ŒæˆæŠ½ç‰Œ</button>
            </div>
        </div>

        <!-- è§£è¯»ç»“æœé¡µé¢ -->
        <div id="result-page" class="page">
            <div class="question-review" id="result-question-review">
                <!-- é—®é¢˜å›é¡¾å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="reading-results">
                <h2 style="text-align: center; color: #ffd700; margin-bottom: 30px; font-size: 2rem;">ä½ çš„å¡”ç½—ç‰Œè§£è¯»</h2>
                <div id="reading-results">
                    <!-- è§£è¯»ç»“æœå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="overall-analysis" id="overall-analysis">
                    <!-- æ•´ä½“åˆ†æå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="newReading()">é‡æ–°æµ‹ç®—</button>
                    <button class="btn" onclick="shareReading()">åˆ†äº«ç»“æœ</button>
                </div>
            </div>
        </div>
    </div>

      <script>
        // å¡”ç½—ç‰Œæ•°æ®ç»“æ„
        const tarotCards = [
          // å¤§é˜¿å°”å¡é‚£ç‰Œ
          {
            id: "fool",
            name: "æ„šè€…",
            nameEn: "The Fool",
            type: "major",
            number: 0,
            image: "https://example.com/images/fool.jpg",
            upright: {
              keywords: ["å¼€å§‹", "è‡ªç”±", "å†’é™©", "çº¯çœŸ", "æ½œèƒ½"],
              meaning: "æ–°çš„å¼€å§‹ï¼Œå……æ»¡å¯èƒ½æ€§çš„æ—…ç¨‹ï¼Œéœ€è¦å‹‡æ°”å’Œä¿¡ä»»",
              love: "æ–°çš„æ‹æƒ…å¯èƒ½æ€§ï¼Œéœ€è¦å‹‡æ•¢è¡¨è¾¾æ„Ÿæƒ…",
              career: "æ–°çš„èŒä¸šæœºä¼šï¼Œé€‚åˆåˆ›ä¸šæˆ–è½¬è¡Œ",
              finance: "è´¢åŠ¡ä¸Šéœ€è¦è°¨æ…ï¼Œä½†æœ‰æ–°çš„æŠ•èµ„æœºä¼š",
              health: "æ•´ä½“å¥åº·è‰¯å¥½ï¼Œéœ€è¦ä¿æŒç§¯æå¿ƒæ€"
            },
            reversed: {
              keywords: ["é²è½", "å¤©çœŸ", "é£é™©", "ä¸æˆç†Ÿ", "ç¼ºä¹è§„åˆ’"],
              meaning: "è¿‡åº¦å†²åŠ¨ï¼Œç¼ºä¹è€ƒè™‘ï¼Œå¯èƒ½å¸¦æ¥ä¸è‰¯åæœ",
              love: "æ„Ÿæƒ…ä¸Šè¿‡äºç†æƒ³åŒ–ï¼Œä¸å¤Ÿæˆç†Ÿ",
              career: "èŒä¸šå†³ç­–è¿‡äºè‰ç‡ï¼Œéœ€è¦è°¨æ…è§„åˆ’",
              finance: "è´¢åŠ¡ä¸Šå†’é£é™©ï¼Œå¯èƒ½å¯¼è‡´æŸå¤±",
              health: "å¿½è§†å¥åº·é—®é¢˜ï¼Œéœ€è¦æ›´åŠ å…³æ³¨èº«ä½“çŠ¶å†µ"
            }
          },
          {
            id: "magician",
            name: "é­”æœ¯å¸ˆ",
            nameEn: "The Magician",
            type: "major",
            number: 1,
            image: "https://example.com/images/magician.jpg",
            upright: {
              keywords: ["åˆ›é€ ", "åŠ›é‡", "ä¸“æ³¨", "æŠ€èƒ½", "æ˜¾åŒ–"],
              meaning: "æ‹¥æœ‰å®ç°ç›®æ ‡çš„èƒ½åŠ›å’Œèµ„æºï¼Œéœ€è¦ä¸»åŠ¨è¡ŒåŠ¨",
              love: "ä¸»åŠ¨è¿½æ±‚çˆ±æƒ…ï¼Œæœ‰é­…åŠ›å’Œå¸å¼•åŠ›",
              career: "å…·å¤‡ä¸“ä¸šæŠ€èƒ½ï¼Œèƒ½å¤ŸæˆåŠŸå®Œæˆé¡¹ç›®",
              finance: "æœ‰èƒ½åŠ›åˆ›é€ è´¢å¯Œï¼Œå–„äºç†è´¢",
              health: "æœ‰æ²»æ„ˆèº«å¿ƒçš„èƒ½åŠ›ï¼Œå¥åº·è‰¯å¥½"
            },
            reversed: {
              keywords: ["æ“çºµ", "æ¬ºéª—", "æ»¥ç”¨æƒåŠ›", "ç¼ºä¹æŠ€èƒ½"],
              meaning: "èƒ½åŠ›è¢«æ»¥ç”¨ï¼Œå¯èƒ½å­˜åœ¨æ¬ºéª—è¡Œä¸º",
              love: "æ„Ÿæƒ…ä¸­å­˜åœ¨æ“æ§æˆ–ä¸è¯šå®",
              career: "ä¸“ä¸šèƒ½åŠ›ä¸è¶³ï¼Œé¡¹ç›®å¯èƒ½å¤±è´¥",
              finance: "ç†è´¢ä¸å½“ï¼Œå¯èƒ½å¯¼è‡´è´¢åŠ¡æŸå¤±",
              health: "å¿½è§†å¥åº·é—®é¢˜ï¼Œéœ€è¦åŠæ—¶æ²»ç–—"
            }
          },
          {
            id: "high-priestess",
            name: "å¥³ç¥­å¸",
            nameEn: "The High Priestess",
            type: "major",
            number: 2,
            image: "https://example.com/images/high-priestess.jpg",
            upright: {
              keywords: ["ç›´è§‰", "æ™ºæ…§", "ç¥ç§˜", "å†…åœ¨å£°éŸ³", "æ½œæ„è¯†çš„"],
              meaning: "ç›¸ä¿¡å†…åœ¨çš„æ™ºæ…§å’Œç›´è§‰ï¼Œéšè—çš„çŸ¥è¯†ä¼šè¢«æ­ç¤º",
              love: "éœ€è¦å€¾å¬å†…å¿ƒçš„å£°éŸ³ï¼Œæ„Ÿæƒ…ä¼šæœ‰æ·±å±‚æ¬¡å‘å±•",
              career: "ä¾é ç›´è§‰åšå†³ç­–ï¼Œä¼šæœ‰æ„æƒ³ä¸åˆ°çš„æœºä¼š",
              finance: "éœ€è¦è°¨æ…åˆ†æè´¢åŠ¡çŠ¶å†µï¼Œä¸è¦æ€¥äºå†³ç­–",
              health: "æ³¨æ„èº«å¿ƒè¿æ¥ï¼Œå†…åœ¨å¹³è¡¡å½±å“å¥åº·"
            },
            reversed: {
              keywords: ["å›°æƒ‘", "ç¼ºä¹ç›´è§‰", "ç§˜å¯†", "éšè—ä¿¡æ¯"],
              meaning: "ç›´è§‰è¢«å¿½è§†ï¼Œå¯èƒ½å­˜åœ¨è¢«éšç’çš„äº‹å®",
              love: "æ„Ÿæƒ…ä¸­ç¼ºä¹æ²Ÿé€šï¼Œå­˜åœ¨è¯¯è§£",
              career: "ä¿¡æ¯ä¸å®Œæ•´ï¼Œå†³ç­–å›°éš¾",
              finance: "è´¢åŠ¡çŠ¶å†µä¸é€æ˜ï¼Œéœ€è¦è°¨æ…",
              health: "å¿½è§†èº«ä½“å‘å‡ºçš„ä¿¡å·ï¼Œå¯èƒ½å­˜åœ¨å¥åº·éšæ‚£"
            }
          },
          {
            id: "empress",
            name: "çš‡å",
            nameEn: "The Empress",
            type: "major",
            number: 3,
            image: "https://example.com/images/empress.jpg",
            upright: {
              keywords: ["ä¸°é¥¶", "æ¯æ€§", "åˆ›é€ ", "å…»è‚²", "ç¾æ„Ÿ"],
              meaning: "åˆ›é€ åŠ›æ—ºç››ï¼Œç”Ÿæ´»å……æ»¡ä¸°ç›ˆå’Œç¾å¥½",
              love: "æ„Ÿæƒ…æ·±åšï¼Œå¯èƒ½æ€€å­•æˆ–æ„Ÿæƒ…è¿›ä¸€æ­¥å‘å±•",
              career: "å·¥ä½œé¡ºåˆ©ï¼Œå¯èƒ½æœ‰æ–°çš„åˆä½œæœºä¼š",
              finance: "è´¢åŠ¡çŠ¶å†µè‰¯å¥½ï¼Œæ”¶å…¥å¢åŠ ",
              health: "èº«ä½“å¥åº·ï¼Œç²¾åŠ›å……æ²›"
            },
            reversed: {
              keywords: ["ä¾èµ–", "åˆ›é€ åŠ›é˜»å¡", "è¿‡åº¦ä¿æŠ¤", "ä¸å®‰å…¨"],
              meaning: "å¯èƒ½è¿‡åº¦ä¾èµ–ä»–äººï¼Œåˆ›é€ åŠ›å—åˆ°é™åˆ¶",
              love: "æ„Ÿæƒ…ä¸­å­˜åœ¨æ§åˆ¶æˆ–ä¸å®‰å…¨æ„Ÿ",
              career: "å·¥ä½œé‡åˆ°é˜»ç¢ï¼Œå‘å±•å—é™",
              finance: "è´¢åŠ¡ä¸Šè¿‡åº¦ä¾èµ–ï¼Œéœ€è¦ç‹¬ç«‹",
              health: "éœ€è¦å…³æ³¨å¥³æ€§å¥åº·é—®é¢˜"
            }
          },
          {
            id: "emperor",
            name: "çš‡å¸",
            nameEn: "The Emperor",
            type: "major",
            number: 4,
            image: "https://example.com/images/emperor.jpg",
            upright: {
              keywords: ["æƒå¨", "ç¨³å®š", "ç»“æ„", "çˆ¶äº²å½¢è±¡", "ç§©åº"],
              meaning: "å»ºç«‹ç§©åºå’Œç¨³å®šï¼Œéœ€è¦é¢†å¯¼å’Œç»„ç»‡èƒ½åŠ›",
              love: "å…³ç³»éœ€è¦æ›´å¤šçš„ç»“æ„å’Œè´£ä»»",
              career: "é¢†å¯¼åœ°ä½ï¼Œäº‹ä¸šæœ‰æˆ",
              finance: "è´¢åŠ¡ç¨³å®šï¼Œå–„äºç®¡ç†",
              health: "èº«ä½“å¼ºå¥ï¼Œä½†éœ€è¦é¿å…è¿‡åº¦å·¥ä½œ"
            },
            reversed: {
              keywords: ["æš´æ”¿", "åˆšæ„è‡ªç”¨", "è¿‡åº¦æ§åˆ¶", "ç¼ºä¹çºªå¾‹"],
              meaning: "å¯èƒ½è¿‡äºä¸“åˆ¶ï¼Œç¼ºä¹çµæ´»æ€§",
              love: "å…³ç³»ä¸­æ§åˆ¶æ¬²è¿‡å¼ºï¼Œéœ€è¦å¹³è¡¡",
              career: "é¢†å¯¼æ–¹å¼ä¸å½“ï¼Œå¯èƒ½é‡åˆ°åæŠ—",
              finance: "è´¢åŠ¡ç®¡ç†è¿‡äºä¸¥æ ¼ï¼Œå½±å“ç”Ÿæ´»è´¨é‡",
              health: "å·¥ä½œå‹åŠ›è¿‡å¤§ï¼Œå½±å“å¥åº·"
            }
          },
          // å°é˜¿å°”å¡é‚£ç‰Œç¤ºä¾‹
          {
            id: "wands-ace",
            name: "æƒæ–ç‹ç‰Œ",
            nameEn: "Ace of Wands",
            type: "minor",
            suit: "wands",
            number: 1,
            image: "https://example.com/images/wands-ace.jpg",
            upright: {
              keywords: ["çµæ„Ÿ", "æ–°å¼€å§‹", "çƒ­æƒ…", "åˆ›é€ åŠ›", "æœºä¼š"],
              meaning: "æ–°çš„åˆ›æ„å’Œæœºä¼šï¼Œå……æ»¡æ¿€æƒ…å’Œèƒ½é‡",
              love: "æ–°çš„æ‹æƒ…å¼€å§‹ï¼Œå……æ»¡æ¿€æƒ…",
              career: "æ–°çš„é¡¹ç›®æˆ–èŒä¸šæœºä¼š",
              finance: "æ–°çš„æŠ•èµ„æœºä¼šï¼Œè´¢åŠ¡å¢é•¿æ½œåŠ›",
              health: "ç²¾åŠ›å……æ²›ï¼Œå……æ»¡æ´»åŠ›"
            },
            reversed: {
              keywords: ["ç¼ºä¹æ–¹å‘", "å»¶è¿Ÿ", "èƒ½é‡é˜»å¡", "å¤±å»çƒ­æƒ…"],
              meaning: "å¯èƒ½ç¼ºä¹æ˜ç¡®çš„æ–¹å‘ï¼Œèƒ½é‡ä¸è¶³",
              love: "æ„Ÿæƒ…ç¼ºä¹æ¿€æƒ…ï¼Œè¿›å±•ç¼“æ…¢",
              career: "é¡¹ç›®å»¶è¿Ÿï¼Œç¼ºä¹åŠ¨åŠ›",
              finance: "æŠ•èµ„æœºä¼šé”™è¿‡ï¼Œè´¢åŠ¡å¢é•¿ç¼“æ…¢",
              health: "ç²¾åŠ›ä¸è¶³ï¼Œéœ€è¦ä¼‘æ¯"
            }
          }
        ];

        // ç‰Œé˜µæ•°æ®ç»“æ„
        const tarotSpreads = [
          {
            id: "one-card",
            name: "å•å¼ ç‰Œ",
            nameEn: "One-Card Spread",
            description: "å¿«é€Ÿè·å¾—å½“ä¸‹çš„æç¤ºã€æ¯æ—¥æŒ‡å¼•ã€ç®€ç­”æ˜¯ï¼å¦é—®é¢˜",
            image: "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=300&fit=crop&crop=center",
            cardCount: 1,
            bestFor: ["love", "career", "finance", "health", "other"],
            positions: [
              {
                id: "single",
                name: "æ ¸å¿ƒæŒ‡å¼•",
                meaning: "é’ˆå¯¹ä½ é—®é¢˜çš„ç›´æ¥ç­”æ¡ˆå’ŒæŒ‡å¼•",
                position: { x: 200, y: 150 }
              }
            ]
          },
          {
            id: "three-card",
            name: "ä¸‰å¼ ç‰Œç‰Œé˜µ",
            nameEn: "Three Card Spread",
            description: "ç»å…¸åŸºç¡€ç‰Œé˜µï¼Œå¯è§£è¯»è¿‡å»-ç°åœ¨-æœªæ¥ã€ä¼˜åŠ¿-åŠ£åŠ¿-å»ºè®®ç­‰å¤šç§æ–¹å¼",
            image: "images/three-card-spread.jpg",
            cardCount: 3,
            bestFor: ["love", "career", "finance", "health", "other"],
            positions: [
              {
                id: "past",
                name: "è¿‡å»",
                meaning: "å½±å“å½“å‰æƒ…å†µçš„åŸºç¡€å’ŒåŸå› ",
                position: { x: 100, y: 150 }
              },
              {
                id: "present",
                name: "ç°åœ¨",
                meaning: "å½“å‰çš„çŠ¶å†µå’ŒæŒ‘æˆ˜",
                position: { x: 250, y: 150 }
              },
              {
                id: "future",
                name: "æœªæ¥",
                meaning: "å¯èƒ½çš„å‘å±•ç»“æœå’Œå»ºè®®",
                position: { x: 400, y: 150 }
              }
            ]
          },
          {
            id: "five-card-cross",
            name: "äº”å¼ ç‰Œåå­—",
            nameEn: "Five-Card Cross",
            description: "ç´§å‡‘çš„åå­—å½¢å¸ƒå±€ï¼Œæä¾›æ¯”ä¸‰å¼ ç‰Œæ›´å¤šå±‚é¢çš„åˆ†æ",
            image: "images/five-card-cross.jpg",
            cardCount: 5,
            bestFor: ["career", "finance", "health", "other"],
            positions: [
              {
                id: "present",
                name: "ç°çŠ¶",
                meaning: "å½“å‰çš„çŠ¶å†µå’Œæƒ…å†µ",
                position: { x: 200, y: 150 }
              },
              {
                id: "challenge",
                name: "æŒ‘æˆ˜",
                meaning: "é¢ä¸´çš„æŒ‘æˆ˜å’Œéšœç¢",
                position: { x: 150, y: 100 }
              },
              {
                id: "subconscious",
                name: "æ½œæ„è¯†",
                meaning: "é—®é¢˜çš„æ ¹æºå’Œæ½œåœ¨å½±å“",
                position: { x: 250, y: 100 }
              },
              {
                id: "conscious",
                name: "æ˜¾æ„è¯†",
                meaning: "å¯è§çš„å½±å“å’Œå¤–åœ¨è¡¨ç°",
                position: { x: 150, y: 200 }
              },
              {
                id: "outcome",
                name: "ç»“æœ",
                meaning: "æœ€ç»ˆçš„ç»“æœå’Œå»ºè®®",
                position: { x: 250, y: 200 }
              }
            ]
          },
          {
            id: "celtic-cross",
            name: "å‡¯å°”ç‰¹åå­—ç‰Œé˜µ",
            nameEn: "Celtic Cross",
            description: "æœ€å…¨é¢å¤æ‚çš„ç‰Œé˜µï¼Œæ·±å…¥åˆ†æå¤æ‚é—®é¢˜çš„å„ä¸ªæ–¹é¢",
            image: "https://images.unsplash.com/photo-1519904981063-b0cf448d479e?w=400&h=300&fit=crop&crop=center",
            cardCount: 10,
            bestFor: ["love", "career", "other"],
            positions: [
              {
                id: "significator",
                name: "ç°çŠ¶",
                meaning: "å½“å‰çŠ¶å†µçš„æ ¸å¿ƒå’Œæœ¬è´¨",
                position: { x: 200, y: 150 }
              },
              {
                id: "crossing",
                name: "æŒ‘æˆ˜",
                meaning: "å½“å‰é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜",
                position: { x: 200, y: 180 }
              },
              {
                id: "crowning",
                name: "ç›®æ ‡",
                meaning: "å¸Œæœ›è¾¾åˆ°çš„ç›®æ ‡å’Œç†æƒ³çŠ¶æ€",
                position: { x: 200, y: 120 }
              },
              {
                id: "beneath",
                name: "åŸºç¡€",
                meaning: "å½±å“å½“å‰æƒ…å†µçš„æ·±å±‚åŸå› ",
                position: { x: 200, y: 210 }
              },
              {
                id: "behind",
                name: "è¿‡å»å½±å“",
                meaning: "åˆšåˆšè¿‡å»çš„å½±å“å› ç´ ",
                position: { x: 150, y: 135 }
              },
              {
                id: "before",
                name: "æœªæ¥å½±å“",
                meaning: "å³å°†åˆ°æ¥çš„å½±å“å› ç´ ",
                position: { x: 250, y: 135 }
              },
              {
                id: "self",
                name: "è‡ªæˆ‘æ€åº¦",
                meaning: "è‡ªå·±å¯¹è¿™ä¸ªé—®é¢˜çš„æ€åº¦å’Œçœ‹æ³•",
                position: { x: 120, y: 180 }
              },
              {
                id: "environment",
                name: "ç¯å¢ƒå½±å“",
                meaning: "å¤–éƒ¨ç¯å¢ƒå’Œä»–äººå¯¹è¿™ä¸ªäº‹æƒ…çš„å½±å“",
                position: { x: 200, y: 250 }
              },
              {
                id: "hopes",
                name: "å¸Œæœ›ææƒ§",
                meaning: "å†…å¿ƒçš„å¸Œæœ›å’Œææƒ§",
                position: { x: 280, y: 180 }
              },
              {
                id: "outcome",
                name: "æœ€ç»ˆç»“æœ",
                meaning: "äº‹æƒ…å¯èƒ½çš„å‘å±•ç»“æœ",
                position: { x: 200, y: 320 }
              }
            ]
          },
          {
            id: "horseshoe",
            name: "ä¸ƒå¼ é©¬è¹„å½¢",
            nameEn: "Horseshoe Spread",
            description: "å¼§å½¢å±•å¼€çš„ä¸ƒå¼ ç‰Œï¼Œé€‚åˆæ¢ç´¢äº‹ä»¶å‘å±•è„‰ç»œ",
            image: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=400&h=300&fit=crop&crop=center",
            cardCount: 7,
            bestFor: ["career", "finance", "health", "other"],
            positions: [
              {
                id: "past",
                name: "è¿‡å»",
                meaning: "è¿‡å»çš„åŸºç¡€å’Œç»å†",
                position: { x: 50, y: 200 }
              },
              {
                id: "present",
                name: "ç°åœ¨",
                meaning: "å½“å‰çš„çŠ¶å†µ",
                position: { x: 120, y: 150 }
              },
              {
                id: "future",
                name: "æœªæ¥è¶‹åŠ¿",
                meaning: "çŸ­æœŸçš„å‘å±•è¶‹åŠ¿",
                position: { x: 190, y: 120 }
              },
              {
                id: "advice",
                name: "å»ºè®®",
                meaning: "å…³é”®çš„è¡ŒåŠ¨å»ºè®®",
                position: { x: 260, y: 120 }
              },
              {
                id: "external",
                name: "å¤–ç•Œå½±å“",
                meaning: "å¤–éƒ¨ç¯å¢ƒå’Œä»–äººå½±å“",
                position: { x: 330, y: 150 }
              },
              {
                id: "action",
                name: "è¡ŒåŠ¨æ–¹é’ˆ",
                meaning: "åº”è¯¥é‡‡å–çš„å…·ä½“è¡ŒåŠ¨",
                position: { x: 400, y: 200 }
              },
              {
                id: "outcome",
                name: "æœ€ç»ˆç»“æœ",
                meaning: "äº‹æƒ…çš„å¯èƒ½ç»“æœ",
                position: { x: 470, y: 250 }
              }
            ]
          },
          {
            id: "relationship",
            name: "äºŒäººå…³ç³»å…­è§’é˜µ",
            nameEn: "Relationship Spread",
            description: "ä¸“ç”¨äºåˆ†ææ‹çˆ±ã€äººé™…ã€åˆä½œç­‰åŒäººå…³ç³»",
            image: "https://images.unsplash.com/photo-1521791136064-7986c2920216?w=400&h=300&fit=crop&crop=center",
            cardCount: 6,
            bestFor: ["love"],
            positions: [
              {
                id: "self-current",
                name: "ä½ ç°çŠ¶",
                meaning: "ä½ å½“å‰çš„çŠ¶æ€å’Œæƒ³æ³•",
                position: { x: 150, y: 200 }
              },
              {
                id: "other-current",
                name: "å¯¹æ–¹ç°çŠ¶",
                meaning: "å¯¹æ–¹å½“å‰çš„çŠ¶æ€å’Œæƒ³æ³•",
                position: { x: 300, y: 120 }
              },
              {
                id: "self-view",
                name: "ä½ çš„çœ‹æ³•",
                meaning: "ä½ å¯¹è¿™æ®µå…³ç³»çš„æ„Ÿå—å’Œçœ‹æ³•",
                position: { x: 200, y: 150 }
              },
              {
                id: "other-view",
                name: "å¯¹æ–¹çœ‹æ³•",
                meaning: "å¯¹æ–¹å¯¹è¿™æ®µå…³ç³»çš„æ„Ÿå—å’Œçœ‹æ³•",
                position: { x: 250, y: 220 }
              },
              {
                id: "strengths",
                name: "å…³ç³»ä¼˜åŠ¿",
                meaning: "è¿™æ®µå…³ç³»çš„ä¼˜ç‚¹å’Œç§¯æå› ç´ ",
                position: { x: 150, y: 100 }
              },
              {
                id: "future",
                name: "æœªæ¥èµ°å‘",
                meaning: "å…³ç³»æœªæ¥çš„å¯èƒ½å‘å±•è¶‹åŠ¿",
                position: { x: 350, y: 200 }
              }
            ]
          }
        ];

        // é—®é¢˜åˆ†ç±»
        const questionCategories = [
          {
            id: "love",
            name: "äº²å¯†å…³ç³»",
            icon: "â¤ï¸",
            description: "æ„Ÿæƒ…ã€æ‹çˆ±ã€å©šå§»ã€äººé™…å…³ç³»"
          },
          {
            id: "career",
            name: "äº‹ä¸š",
            icon: "ğŸ’¼",
            description: "å·¥ä½œã€èŒä¸šå‘å±•ã€å­¦ä¹ ã€é¡¹ç›®"
          },
          {
            id: "finance",
            name: "è´¢å¯Œ",
            icon: "ğŸ’°",
            description: "è´¢åŠ¡ã€æŠ•èµ„ã€æ”¶å…¥ã€æ¶ˆè´¹"
          },
          {
            id: "health",
            name: "å¥åº·",
            icon: "ğŸ¥",
            description: "èº«ä½“å¥åº·ã€å¿ƒç†å¥åº·ã€ç”Ÿæ´»æ–¹å¼"
          },
          {
            id: "other",
            name: "å…¶ä»–",
            icon: "ğŸ¯",
            description: "å…¶ä»–ç”Ÿæ´»é—®é¢˜å’Œå†³ç­–"
          }
        ];

        // å¯¼å‡ºæ•°æ®ï¼ˆå…¨å±€å˜é‡ï¼‰
        window.tarotData = {
          tarotCards,
          tarotSpreads,
          questionCategories
        };

        // æ·»åŠ åŠ è½½å®Œæˆæ ‡è®°
        console.log('âœ… å¡”ç½—ç‰Œæ•°æ®åŠ è½½å®Œæˆ');
        console.log('window.tarotData å·²è®¾ç½®:', window.tarotData);
        console.log('questionCategories æ•°ç»„é•¿åº¦:', window.tarotData.questionCategories.length);
    </script>
    <script>
        // ç«‹å³æ£€æŸ¥æ•°æ®æ˜¯å¦åŠ è½½
        console.log('ğŸ“‹ è„šæœ¬æ ‡ç­¾åŠ è½½åç«‹å³æ£€æŸ¥:');
        console.log('- window.tarotData:', window.tarotData);
        console.log('- window.tarotData.questionCategories:', window.tarotData ? window.tarotData.questionCategories : 'undefined');

        // æ·»åŠ å…¨å±€æ£€æŸ¥å‡½æ•°
        window.checkTarotData = function() {
            console.log('ğŸ” æ‰‹åŠ¨æ£€æŸ¥ tarotData:');
            console.log('window.tarotData å­˜åœ¨:', !!window.tarotData);
            if (window.tarotData) {
                console.log('å±æ€§:', Object.keys(window.tarotData));
                console.log('questionCategories:', window.tarotData.questionCategories);
            }
            return window.tarotData;
        };
    </script>
    <script>
        // å…¨å±€å˜é‡
        let selectedQuestionType = null;
        let userQuestion = '';
        let currentSpread = null;
        let drawnCards = [];
        let currentCardIndex = 0;

        // ç”Ÿæˆæ˜Ÿç©ºèƒŒæ™¯
        function generateStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 100;

            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // æ›´æ–°è°ƒè¯•ä¿¡æ¯
        function updateDebugInfo(message, data = null) {
            const debugContent = document.getElementById('debug-content');
            if (debugContent) {
                const timestamp = new Date().toLocaleTimeString();
                let debugText = `[${timestamp}] ${message}`;
                if (data) {
                    debugText += '\n' + JSON.stringify(data, null, 2);
                }
                debugContent.innerHTML = debugText.replace(/\n/g, '<br>');
            }
        }

        // åˆå§‹åŒ–é¡µé¢
        function initializePage() {
            console.log('=== é¡µé¢å¼€å§‹åˆå§‹åŒ– ===');
            console.log('å½“å‰æ—¶é—´:', new Date().toISOString());
            updateDebugInfo('é¡µé¢å¼€å§‹åˆå§‹åŒ–', { tarotData: !!window.tarotData });

            generateStars();

            // ç«‹å³æ£€æŸ¥æ•°æ®æ˜¯å¦å·²åŠ è½½
            if (window.tarotData && window.tarotData.questionCategories) {
                console.log('âœ… æ•°æ®å·²åŠ è½½ï¼Œç›´æ¥æ¸²æŸ“');
                console.log('questionCategories:', window.tarotData.questionCategories);
                updateDebugInfo('æ•°æ®å·²åŠ è½½ï¼Œç›´æ¥æ¸²æŸ“', {
                    questionCategoriesLength: window.tarotData.questionCategories.length,
                    questionCategories: window.tarotData.questionCategories.map(c => ({ id: c.id, name: c.name }))
                });
                renderQuestionCategories();
            } else {
                console.log('âŒ æ•°æ®æœªåŠ è½½ï¼Œç­‰å¾…æ•°æ®åŠ è½½...');
                console.log('window.tarotData ç±»å‹:', typeof window.tarotData);
                console.log('window.tarotData å†…å®¹:', window.tarotData);
                updateDebugInfo('æ•°æ®æœªåŠ è½½ï¼Œç­‰å¾…æ•°æ®åŠ è½½', {
                    tarotDataExists: !!window.tarotData,
                    tarotDataType: typeof window.tarotData,
                    questionCategoriesExists: window.tarotData ? !!window.tarotData.questionCategories : false
                });

                // ç­‰å¾…æ•°æ®åŠ è½½
                let attempts = 0;
                const checkDataInterval = setInterval(() => {
                    attempts++;
                    console.log(`--- å°è¯• ${attempts} ---`);
                    console.log('window.tarotData å­˜åœ¨:', !!window.tarotData);

                    if (window.tarotData) {
                        console.log('tarotData å±æ€§:', Object.keys(window.tarotData));
                        console.log('questionCategories å­˜åœ¨:', !!window.tarotData.questionCategories);
                        console.log('questionCategories ç±»å‹:', typeof window.tarotData.questionCategories);
                    }

                    updateDebugInfo(`å°è¯• ${attempts} æ£€æŸ¥æ•°æ®`, {
                        tarotDataExists: !!window.tarotData,
                        hasQuestionCategories: window.tarotData ? !!window.tarotData.questionCategories : false,
                        questionCategoriesType: window.tarotData ? typeof window.tarotData.questionCategories : 'N/A'
                    });

                    if (window.tarotData && window.tarotData.questionCategories) {
                        clearInterval(checkDataInterval);
                        console.log('âœ… æ•°æ®åŠ è½½å®Œæˆï¼Œå¼€å§‹æ¸²æŸ“');
                        console.log('questionCategories æ•°ç»„é•¿åº¦:', window.tarotData.questionCategories.length);
                        updateDebugInfo('æ•°æ®åŠ è½½å®Œæˆï¼Œå¼€å§‹æ¸²æŸ“', {
                            length: window.tarotData.questionCategories.length,
                            firstItem: window.tarotData.questionCategories[0]
                        });
                        renderQuestionCategories();
                    } else if (attempts > 15) {
                        clearInterval(checkDataInterval);
                        console.error('âŒ æ•°æ®åŠ è½½è¶…æ—¶');
                        console.log('æœ€ç»ˆçŠ¶æ€æ£€æŸ¥:');
                        console.log('- window.tarotData:', window.tarotData);
                        console.log('- typeof window.tarotData:', typeof window.tarotData);
                        updateDebugInfo('âŒ æ•°æ®åŠ è½½è¶…æ—¶', {
                            finalTarotData: window.tarotData,
                            finalType: typeof window.tarotData
                        });
                        renderQuestionCategories(); // å°è¯•æ¸²æŸ“ï¼Œä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    }
                }, 300);
            }
        }

        // æ¸²æŸ“é—®é¢˜åˆ†ç±»
        function renderQuestionCategories() {
            const container = document.getElementById('question-categories');

            // é¦–å…ˆæ¸…é™¤æ‰€æœ‰ç°æœ‰å†…å®¹ï¼ˆåŒ…æ‹¬æµ‹è¯•å†…å®¹ï¼‰
            container.innerHTML = '';

            console.log('=== å¼€å§‹æ¸²æŸ“é—®é¢˜åˆ†ç±» ===');
            console.log('å½“å‰æ—¶é—´:', new Date().toISOString());
            console.log('container å…ƒç´ :', container);

            try {
                console.log('window.tarotData:', window.tarotData);
                console.log('window.tarotData ç±»å‹:', typeof window.tarotData);

                // æ£€æŸ¥æ•°æ®æ˜¯å¦åŠ è½½
                if (!window.tarotData) {
                    const errorMsg = 'âš ï¸ window.tarotData ä¸å­˜åœ¨';
                    container.innerHTML = `
                        <div style="color: red; text-align: center; padding: 20px;">
                            <p style="font-size: 1.2em; margin-bottom: 10px;">${errorMsg}</p>
                            <p style="color: #888;">è¯·ç¡®ä¿æ•°æ®æ­£ç¡®åŠ è½½</p>
                            <p style="color: #666; font-size: 0.9em; margin-top: 10px;">è¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ (F12)</p>
                        </div>
                    `;
                    console.error(errorMsg);
                    return;
                }

                console.log('tarotData å±æ€§:', Object.keys(window.tarotData));

                if (!window.tarotData.questionCategories) {
                    const errorMsg = 'âš ï¸ window.tarotData.questionCategories ä¸å­˜åœ¨';
                    container.innerHTML = `
                        <div style="color: red; text-align: center; padding: 20px;">
                            <p style="font-size: 1.2em; margin-bottom: 10px;">${errorMsg}</p>
                            <p style="color: #888;">æ•°æ®ç»“æ„å¯èƒ½æœ‰é—®é¢˜</p>
                            <p style="color: #666; font-size: 0.9em;">tarotData åŒ…å«: ${Object.keys(window.tarotData).join(', ')}</p>
                        </div>
                    `;
                    console.error(errorMsg, window.tarotData);
                    return;
                }

                if (!Array.isArray(window.tarotData.questionCategories)) {
                    const errorMsg = 'âš ï¸ questionCategories ä¸æ˜¯æ•°ç»„';
                    container.innerHTML = `
                        <div style="color: red; text-align: center; padding: 20px;">
                            <p style="font-size: 1.2em; margin-bottom: 10px;">${errorMsg}</p>
                            <p style="color: #888;">æœŸæœ›æ•°ç»„æ ¼å¼ï¼Œå®é™…ç±»å‹: ${typeof window.tarotData.questionCategories}</p>
                            <p style="color: #666; font-size: 0.9em;">å€¼: ${window.tarotData.questionCategories}</p>
                        </div>
                    `;
                    console.error(errorMsg, window.tarotData.questionCategories);
                    return;
                }

                console.log('âœ… æ•°æ®éªŒè¯é€šè¿‡ï¼Œå¼€å§‹æ¸²æŸ“åˆ†ç±»...');
                console.log('questionCategories æ•°ç»„é•¿åº¦:', window.tarotData.questionCategories.length);
                console.log('questionCategories å†…å®¹:', window.tarotData.questionCategories);

                window.tarotData.questionCategories.forEach((category, index) => {
                    console.log(`å¤„ç†ç¬¬ ${index} ä¸ªåˆ†ç±»:`, category);

                    const categoryCard = document.createElement('div');
                    categoryCard.className = 'category-card';
                    categoryCard.onclick = () => selectQuestionType(category);

                    categoryCard.innerHTML = `
                        <div class="category-icon">${category.icon || 'â“'}</div>
                        <div class="category-name">${category.name || 'æœªå‘½ååˆ†ç±»'}</div>
                        <div class="category-description">${category.description || 'æš‚æ— æè¿°'}</div>
                    `;

                    container.appendChild(categoryCard);
                });

                console.log('âœ… é—®é¢˜åˆ†ç±»æ¸²æŸ“å®Œæˆï¼Œå…±æ¸²æŸ“äº†', container.children.length, 'ä¸ªåˆ†ç±»');

                // å¦‚æœæ²¡æœ‰æ¸²æŸ“ä»»ä½•å†…å®¹ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                if (container.children.length === 0) {
                    container.innerHTML = '<p style="color: orange; text-align: center; padding: 20px;">âš ï¸ æ²¡æœ‰å¯æ˜¾ç¤ºçš„é—®é¢˜åˆ†ç±»</p><p style="color: #888; text-align: center;">æ•°æ®å¯èƒ½ä¸ºç©º</p>';
                }

            } catch (error) {
                console.error('âŒ æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:', error);
                container.innerHTML = `
                    <div style="color: red; text-align: center; padding: 20px;">
                        <p style="font-size: 1.2em; margin-bottom: 10px;">âŒ æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯</p>
                        <p style="color: #888; margin-bottom: 10px;">é”™è¯¯ä¿¡æ¯: ${error.message}</p>
                        <p style="color: #666; font-size: 0.9em;">è¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ (F12)</p>
                    </div>
                `;
            }
        }

        // é€‰æ‹©é—®é¢˜ç±»å‹
        function selectQuestionType(category) {
            // ç§»é™¤å…¶ä»–é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.category-card').forEach(card => {
                card.classList.remove('selected');
            });

            // æ·»åŠ é€‰ä¸­çŠ¶æ€
            event.target.closest('.category-card').classList.add('selected');
            selectedQuestionType = category;

            // å»¶è¿Ÿè·³è½¬åˆ°é—®é¢˜è¾“å…¥é¡µé¢
            setTimeout(() => {
                showPage('question-input-page');
            }, 800);
        }

        // è¿”å›é—®é¢˜ç±»å‹é€‰æ‹©
        function backToQuestionType() {
            selectedQuestionType = null;
            document.getElementById('user-question').value = '';
            showPage('question-type-page');
        }

        // è¿›å…¥ç‰Œé˜µé€‰æ‹©
        function proceedToSpreadSelection() {
            const questionInput = document.getElementById('user-question').value.trim();

            if (!questionInput) {
                alert('è¯·æè¿°ä½ æƒ³è¦å åœçš„é—®é¢˜');
                return;
            }

            userQuestion = questionInput;
            renderQuestionReview();
            renderSpreadSelection();
            showPage('spread-selection-page');
        }

        // è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥é€‰æ‹©ç‰Œé˜µ
        function skipToSpreadSelection() {
            userQuestion = 'ç”¨æˆ·é€‰æ‹©è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥è¿›è¡Œå¡”ç½—ç‰Œæµ‹ç®—';
            renderQuestionReview();
            renderSpreadSelection();
            showPage('spread-selection-page');
        }

        // æ¸²æŸ“é—®é¢˜å›é¡¾
        function renderQuestionReview() {
            const container = document.getElementById('question-review');

            if (userQuestion === 'ç”¨æˆ·é€‰æ‹©è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥è¿›è¡Œå¡”ç½—ç‰Œæµ‹ç®—') {
                container.innerHTML = `
                    <h3>ç›´æ¥æµ‹ç®—æ¨¡å¼</h3>
                    <p><strong>å’¨è¯¢é¢†åŸŸï¼š</strong>${selectedQuestionType.name}</p>
                    <p><strong>æ¨¡å¼ï¼š</strong>è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥è¿›è¡Œå¡”ç½—ç‰Œæµ‹ç®—</p>
                    <p><em>ğŸ’« ä½ é€‰æ‹©äº†å¿«é€Ÿæµ‹ç®—æ¨¡å¼ï¼Œç³»ç»Ÿå°†ä¸ºä½ æä¾›é€šç”¨çš„å¡”ç½—ç‰ŒæŒ‡å¼•</em></p>
                `;
            } else {
                container.innerHTML = `
                    <h3>ä½ çš„é—®é¢˜</h3>
                    <p><strong>å’¨è¯¢é¢†åŸŸï¼š</strong>${selectedQuestionType.name}</p>
                    <p><strong>å…·ä½“é—®é¢˜ï¼š</strong>${userQuestion}</p>
                `;
            }
        }

        // æ¸²æŸ“ç‰Œé˜µé€‰æ‹©
        function renderSpreadSelection() {
            const container = document.getElementById('spread-selection');
            container.innerHTML = '';

            // æ£€æŸ¥æ˜¯å¦ä¸ºè·³è¿‡æ¨¡å¼
            const isSkipMode = userQuestion === 'ç”¨æˆ·é€‰æ‹©è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥è¿›è¡Œå¡”ç½—ç‰Œæµ‹ç®—';

            let sortedSpreads;
            if (isSkipMode) {
                // è·³è¿‡æ¨¡å¼ï¼šä¸è¿›è¡Œæ¨èæ’åºï¼Œä¿æŒåŸå§‹é¡ºåº
                sortedSpreads = [...window.tarotData.tarotSpreads];
            } else {
                // æ­£å¸¸æ¨¡å¼ï¼šå¯¹ç‰Œé˜µè¿›è¡Œæ’åºï¼Œæ¨èçš„æ”¾åœ¨å‰é¢
                sortedSpreads = [...window.tarotData.tarotSpreads].sort((a, b) => {
                    const aRecommended = a.bestFor.includes(selectedQuestionType.id);
                    const bRecommended = b.bestFor.includes(selectedQuestionType.id);

                    if (aRecommended && !bRecommended) return -1; // aæ¨èï¼Œbä¸æ¨èï¼Œaæ’åœ¨å‰é¢
                    if (!aRecommended && bRecommended) return 1;  // aä¸æ¨èï¼Œbæ¨èï¼Œbæ’åœ¨å‰é¢
                    return 0; // éƒ½æ¨èæˆ–éƒ½ä¸æ¨èï¼Œä¿æŒåŸé¡ºåº
                });
            }

            sortedSpreads.forEach(spread => {
                const isRecommended = !isSkipMode && spread.bestFor.includes(selectedQuestionType.id);

                const spreadCard = document.createElement('div');
                spreadCard.className = `spread-card ${isRecommended ? 'recommended' : ''}`;
                spreadCard.onclick = () => selectSpread(spread);

                spreadCard.innerHTML = `
                    <div class="spread-image">
                        <img src="${spread.image}" alt="${spread.name}" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=400&h=300&fit=crop&crop=center'">
                    </div>
                    <div class="spread-name">${spread.name}</div>
                    <div class="spread-description">${spread.description}</div>
                    <div class="spread-info">${spread.cardCount} å¼ ç‰Œ</div>
                `;

                container.appendChild(spreadCard);
            });
        }

        // é€‰æ‹©ç‰Œé˜µ
        function selectSpread(spread) {
            currentSpread = spread;
            drawnCards = [];
            currentCardIndex = 0;

            document.getElementById('spread-title').textContent = spread.name;
            document.getElementById('spread-description').textContent = spread.description;

            renderSpreadLayout();
            updateProgress();
            showPage('reading-page');
        }

        // æ¸²æŸ“ç‰Œé˜µå¸ƒå±€
        function renderSpreadLayout() {
            const container = document.getElementById('spread-layout');
            container.innerHTML = '';

            // æ ¹æ®ç‰Œé˜µç±»å‹æ·»åŠ ç‰¹æ®Šæ ·å¼ç±»
            switch (currentSpread.id) {
                case 'one-card':
                    container.className = 'spread-layout one-card';
                    break;
                case 'three-card':
                    container.className = 'spread-layout three-cards';
                    break;
                case 'five-card-cross':
                    container.className = 'spread-layout five-cross';
                    break;
                case 'star':
                    container.className = 'spread-layout star-spread';
                    break;
                case 'horseshoe':
                    container.className = 'spread-layout horseshoe-layout';
                    break;
                case 'relationship':
                    container.className = 'spread-layout relationship-layout';
                    break;
                case 'celtic-cross':
                    container.className = 'spread-layout celtic-cross';
                    break;
                default:
                    container.className = 'spread-layout';
            }

            // ä½¿ç”¨æ›´ç®€å•å’Œå¯é çš„æ–¹å¼æ¥è®¡ç®—ä½ç½®
            const containerRect = container.getBoundingClientRect();
            const centerX = containerRect.width / 2;
            const centerY = containerRect.height / 2;

            currentSpread.positions.forEach((position, index) => {
                const slot = document.createElement('div');
                slot.className = 'card-slot';
                slot.id = `slot-${index}`;

                // ç®€åŒ–çš„å¸ƒå±€è®¡ç®—ï¼Œç¡®ä¿æ‰€æœ‰ç‰Œéƒ½åœ¨ä¸­å¤®å¯è§
                let adjustedX = centerX - 40; // é»˜è®¤å±…ä¸­å‡å»å¡ç‰‡å®½åº¦çš„ä¸€åŠ
                let adjustedY = centerY - 60; // é»˜è®¤å±…ä¸­å‡å»å¡ç‰‡é«˜åº¦çš„ä¸€åŠ

                // æ ¹æ®ä¸åŒç‰Œé˜µç±»å‹è®¡ç®—ä½ç½®
                switch (currentSpread.id) {
                    case 'one-card':
                        // å•å¼ ç‰Œå®Œå…¨å±…ä¸­
                        adjustedX = centerX - 75;
                        adjustedY = centerY - 110;
                        break;

                    case 'three-card':
                        // ä¸‰å¼ ç‰Œæ¨ªå‘å‡åŒ€åˆ†å¸ƒ
                        adjustedX = (centerX - 180) + (index * 180);
                        adjustedY = centerY - 90;
                        break;

                    case 'five-card-cross':
                        // äº”å¼ ç‰Œåå­—å¸ƒå±€
                        switch (index) {
                            case 0: // ä¸­å¿ƒ
                                adjustedX = centerX - 45;
                                adjustedY = centerY - 67;
                                break;
                            case 1: // ä¸Š
                                adjustedX = centerX - 45;
                                adjustedY = centerY - 140;
                                break;
                            case 2: // ä¸‹
                                adjustedX = centerX - 45;
                                adjustedY = centerY + 40;
                                break;
                            case 3: // å·¦
                                adjustedX = centerX - 110;
                                adjustedY = centerY - 67;
                                break;
                            case 4: // å³
                                adjustedX = centerX + 20;
                                adjustedY = centerY - 67;
                                break;
                        }
                        break;

                    case 'relationship':
                        // äºŒäººå…³ç³»å…­è§’é˜µ - ç®€åŒ–çš„å…­è§’å½¢
                        const radius = 100;
                        const angle = (index * Math.PI * 2) / 6; // 60åº¦é—´éš”
                        adjustedX = centerX + Math.cos(angle - Math.PI/2) * radius - 42;
                        adjustedY = centerY + Math.sin(angle - Math.PI/2) * radius - 65;
                        break;

                    case 'celtic-cross':
                        // å‡¯å°”ç‰¹åå­— - ç´§å‡‘å¸ƒå±€
                        switch (index) {
                            case 0: case 1: // ç¬¬1ã€2å¼ ç‰Œé‡å ï¼ˆä¸­å¿ƒï¼‰
                                adjustedX = centerX - 35;
                                adjustedY = centerY - 52;
                                break;
                            case 2: // ä¸Š
                                adjustedX = centerX - 35;
                                adjustedY = centerY - 90;
                                break;
                            case 3: // ä¸‹
                                adjustedX = centerX - 35;
                                adjustedY = centerY - 10;
                                break;
                            case 4: // å·¦
                                adjustedX = centerX - 70;
                                adjustedY = centerY - 52;
                                break;
                            case 5: // å³
                                adjustedX = centerX;
                                adjustedY = centerY - 52;
                                break;
                            case 6: // å³ä¸Š
                                adjustedX = centerX + 15;
                                adjustedY = centerY - 90;
                                break;
                            case 7: // ä¸‹ä¸‹
                                adjustedX = centerX - 35;
                                adjustedY = centerY + 30;
                                break;
                            case 8: // å·¦ä¸‹
                                adjustedX = centerX - 70;
                                adjustedY = centerY - 10;
                                break;
                            case 9: // æœ€ä¸‹
                                adjustedX = centerX - 35;
                                adjustedY = centerY + 70;
                                break;
                        }
                        break;

                    case 'horseshoe':
                        // é©¬è¹„å½¢ - ç´§å‡‘çš„Uå½¢æ’åˆ—
                        const baseY = centerY - 20;
                        switch (index) {
                            case 0: // æœ€å·¦
                                adjustedX = centerX - 150;
                                adjustedY = baseY;
                                break;
                            case 1: // å·¦ä¸Š
                                adjustedX = centerX - 100;
                                adjustedY = baseY - 40;
                                break;
                            case 2: // ä¸Šä¸­
                                adjustedX = centerX - 50;
                                adjustedY = baseY - 60;
                                break;
                            case 3: // å³ä¸Š
                                adjustedX = centerX;
                                adjustedY = baseY - 40;
                                break;
                            case 4: // æœ€å³
                                adjustedX = centerX + 50;
                                adjustedY = baseY;
                                break;
                            case 5: // å³ä¸‹
                                adjustedX = centerX + 25;
                                adjustedY = baseY + 40;
                                break;
                            case 6: // æœ€å³ä¸‹
                                adjustedX = centerX + 75;
                                adjustedY = baseY + 60;
                                break;
                        }
                        break;

                    default:
                        // å…¶ä»–ç‰Œé˜µä½¿ç”¨ç®€åŒ–çš„å±…ä¸­å¸ƒå±€
                        adjustedX = centerX - 40 + (index * 30);
                        adjustedY = centerY - 60 + (index * 20);
                }

                // ç¡®ä¿ä½ç½®ä¸è¶…å‡ºè¾¹ç•Œ
                adjustedX = Math.max(10, Math.min(adjustedX, containerRect.width - 90));
                adjustedY = Math.max(10, Math.min(adjustedY, containerRect.height - 130));

                slot.style.left = adjustedX + 'px';
                slot.style.top = adjustedY + 'px';
                slot.innerHTML = '?';
                container.appendChild(slot);
            });
        }

        // æŠ½ç‰ŒåŠŸèƒ½
        function drawCard() {
            if (currentCardIndex >= currentSpread.cardCount) {
                return;
            }

            // éšæœºé€‰æ‹©ä¸€å¼ ç‰Œ
            const availableCards = window.tarotData.tarotCards.filter(card =>
                !drawnCards.some(drawn => drawn.id === card.id)
            );

            let selectedCard;
            if (availableCards.length === 0) {
                // å¦‚æœç‰Œä¸å¤Ÿç”¨ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨
                selectedCard = window.tarotData.tarotCards[Math.floor(Math.random() * window.tarotData.tarotCards.length)];
            } else {
                selectedCard = availableCards[Math.floor(Math.random() * availableCards.length)];
            }

            const isReversed = Math.random() > 0.5;

            drawnCards.push({
                ...selectedCard,
                isReversed: isReversed,
                position: currentSpread.positions[currentCardIndex]
            });

            // åœ¨å¸ƒå±€ä¸­æ˜¾ç¤ºç‰Œ
            const slot = document.getElementById(`slot-${currentCardIndex}`);
            slot.className = 'card-slot filled';

            // ç‰¹æ®Šå¤„ç†å‡¯å°”ç‰¹åå­—çš„ç¬¬2å¼ ç‰Œï¼Œæ·»åŠ é‡å æ•ˆæœ
            let cardClass = `tarot-card ${drawnCards[currentCardIndex].isReversed ? 'reversed' : ''}`;
            let cardStyle = '';

            if (currentSpread.id === 'celtic-cross' && currentCardIndex === 1) {
                cardClass += ' overlapping-card';
                cardStyle = 'transform: rotate(8deg); z-index: 10; background: linear-gradient(135deg, #3c3c74, #50509a);';
            }

            slot.innerHTML = `
                <div class="${cardClass}" style="${cardStyle}">
                    ${drawnCards[currentCardIndex].name.charAt(0)}
                </div>
            `;

            currentCardIndex++;

            // æ›´æ–°è¿›åº¦
            updateProgress();

            // æ£€æŸ¥æ˜¯å¦å®Œæˆ
            if (currentCardIndex >= currentSpread.cardCount) {
                document.getElementById('draw-card-btn').style.display = 'none';
                document.getElementById('complete-reading-btn').style.display = 'inline-block';
            }
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const progressFill = document.getElementById('progress-fill');
            const progressInfo = document.getElementById('progress-info');

            const progress = (currentCardIndex / currentSpread.cardCount) * 100;
            progressFill.style.width = progress + '%';
            progressInfo.textContent = `å·²æŠ½å– ${currentCardIndex} / ${currentSpread.cardCount} å¼ ç‰Œ`;
        }

        // å®ŒæˆæŠ½ç‰Œï¼Œè¿›å…¥è§£è¯»é¡µé¢
        function proceedToQuestionCategory() {
            generateReading();
            showPage('result-page');
        }

        // ç”Ÿæˆè§£è¯»
        function generateReading() {
            // åœ¨ç»“æœé¡µé¢æ˜¾ç¤ºé—®é¢˜å›é¡¾
            const resultQuestionReview = document.getElementById('result-question-review');
            resultQuestionReview.innerHTML = `
                <h3>ä½ çš„é—®é¢˜</h3>
                <p><strong>å’¨è¯¢é¢†åŸŸï¼š</strong>${selectedQuestionType.name}</p>
                <p><strong>å…·ä½“é—®é¢˜ï¼š</strong>${userQuestion}</p>
                <p><strong>ä½¿ç”¨ç‰Œé˜µï¼š</strong>${currentSpread.name}</p>
            `;

            const results = generateDetailedInterpretation();
            renderReadingResults(results);
        }

        // ç”Ÿæˆè¯¦ç»†è§£è¯»
        function generateDetailedInterpretation() {
            return drawnCards.map((card, index) => {
                const meaning = card.isReversed ? card.reversed : card.upright;
                const categoryMeaning = meaning[selectedQuestionType.id] || meaning.meaning;

                // æ ¹æ®ç”¨æˆ·é—®é¢˜å’Œä½ç½®ç”Ÿæˆä¸ªæ€§åŒ–è§£è¯»ï¼ˆçº¦100å­—ï¼‰
                const interpretation = generatePersonalizedInterpretation(
                    card,
                    card.position,
                    userQuestion,
                    selectedQuestionType,
                    categoryMeaning
                );

                return {
                    position: card.position,
                    card: card,
                    interpretation: interpretation
                };
            });
        }

        // ç”Ÿæˆä¸ªæ€§åŒ–è§£è¯»
        // è·å–ä½ç½®è¯­å¢ƒ
        function getPositionContext(positionId, questionType) {
            const contexts = {
                love: {
                    past: 'å›é¡¾è¿‡å»çš„æ„Ÿæƒ…ç»å†ï¼Œä»ä¸­å­¦ä¹ å’Œæˆé•¿',
                    present: 'è®¤æ¸…å½“å‰æ„Ÿæƒ…çš„çœŸå®çŠ¶å†µ',
                    future: 'å±•æœ›æ„Ÿæƒ…å‘å±•çš„å¯èƒ½æ€§å’Œæ–¹å‘',
                    single: 'ä¸“æ³¨äºè‡ªå·±å†…åœ¨çš„æƒ…æ„Ÿéœ€æ±‚',
                    challenge: 'å‹‡æ•¢é¢å¯¹æ„Ÿæƒ…ä¸­çš„æŒ‘æˆ˜å’Œå›°éš¾',
                    advice: 'æ¥å—æ™ºæ…§çš„å»ºè®®ï¼Œæ”¹å–„å…³ç³»è´¨é‡',
                    outcome: 'ç›¸ä¿¡æ„Ÿæƒ…æœ€ç»ˆä¼šæœç€æœ€å¥½çš„æ–¹å‘å‘å±•',
                    'self-current': 'äº†è§£è‡ªå·±åœ¨å…³ç³»ä¸­çš„çœŸå®çŠ¶æ€',
                    'other-current': 'ç†è§£å¯¹æ–¹çš„æ„Ÿå—å’Œéœ€æ±‚',
                    'self-view': 'å®¡è§†è‡ªå·±å¯¹å…³ç³»çš„çœ‹æ³•å’ŒæœŸå¾…',
                    'other-view': 'ä½“ä¼šå¯¹æ–¹å¯¹å…³ç³»çš„æ„Ÿå—',
                    strengths: 'å‘æŒ¥å…³ç³»ä¸­çš„ä¼˜åŠ¿å’Œç§¯æå› ç´ ',
                    'future-direction': 'æŠŠæ¡å…³ç³»æœªæ¥çš„å‘å±•è¶‹åŠ¿'
                },
                career: {
                    past: 'æ€»ç»“è¿‡å¾€çš„èŒä¸šç»éªŒå’Œæ•™è®­',
                    present: 'è®¤æ¸…å½“å‰å·¥ä½œçš„çœŸå®æƒ…å†µ',
                    future: 'è§„åˆ’èŒä¸šå‘å±•çš„é•¿è¿œç›®æ ‡',
                    challenge: 'å‹‡äºé¢å¯¹å·¥ä½œä¸­çš„æŒ‘æˆ˜',
                    advice: 'æ¥å—èŒä¸šå‘å±•ä¸­çš„ä¸“ä¸šå»ºè®®',
                    outcome: 'ç›¸ä¿¡èŒä¸šé“è·¯ä¼šé€æ­¥æ˜æœ—åŒ–',
                    significator: 'æ˜ç¡®å½“å‰èŒä¸šçš„æ ¸å¿ƒçŠ¶å†µ',
                    crossing: 'è¯†åˆ«å½±å“èŒä¸šå‘å±•çš„ä¸»è¦éšœç¢',
                    crowning: 'è®¾ç«‹æ¸…æ™°çš„èŒä¸šç›®æ ‡',
                    beneath: 'äº†è§£å½±å“èŒä¸šå‘å±•çš„æ·±å±‚å› ç´ ',
                    action: 'é‡‡å–å…·ä½“çš„èŒä¸šè¡ŒåŠ¨æ­¥éª¤'
                },
                finance: {
                    past: 'åˆ†æè¿‡å»çš„è´¢åŠ¡å†³ç­–å’Œç»“æœ',
                    present: 'è®¤æ¸…å½“å‰è´¢åŠ¡çš„çœŸå®çŠ¶å†µ',
                    future: 'è§„åˆ’è´¢åŠ¡å‘å±•çš„é•¿è¿œç›®æ ‡',
                    challenge: 'è°¨æ…å¤„ç†è´¢åŠ¡ä¸Šçš„æŒ‘æˆ˜',
                    advice: 'æ¥å—ç†è´¢çš„ä¸“ä¸šå»ºè®®',
                    outcome: 'ç›¸ä¿¡è´¢åŠ¡çŠ¶å†µä¼šé€æ­¥æ”¹å–„',
                    conscious: 'æ³¨æ„æ˜¾æ€§çš„è´¢åŠ¡å½±å“å› ç´ ',
                    subconscious: 'å…³æ³¨æ½œåœ¨çš„è´¢åŠ¡æ¨¡å¼å’Œä¿¡å¿µ'
                },
                health: {
                    past: 'å›é¡¾è¿‡å¾€çš„å¥åº·çŠ¶å†µå’Œä¹ æƒ¯',
                    present: 'å…³æ³¨å½“å‰èº«ä½“çš„çœŸå®ä¿¡å·',
                    future: 'é¢„é˜²å¯èƒ½å‡ºç°çš„å¥åº·é—®é¢˜',
                    challenge: 'ç§¯æé¢å¯¹å¥åº·æ–¹é¢çš„æŒ‘æˆ˜',
                    advice: 'æ¥å—å¥åº·ç”Ÿæ´»çš„ä¸“ä¸šå»ºè®®',
                    outcome: 'ç›¸ä¿¡èº«ä½“çŠ¶å†µä¼šé€æ­¥æ”¹å–„',
                    conscious: 'æ³¨æ„æ˜¾æ€§çš„å¥åº·å½±å“å› ç´ ',
                    subconscious: 'å…³æ³¨æ½œåœ¨çš„å¥åº·æ¨¡å¼å’Œæƒ…ç»ª'
                },
                general: {
                    past: 'ä»è¿‡å»çš„ç»å†ä¸­å¯»æ‰¾ç­”æ¡ˆ',
                    present: 'è®¤æ¸…å½“å‰çŠ¶å†µçš„çœŸå®é¢ç›®',
                    future: 'å±•æœ›æœªæ¥å‘å±•çš„å¯èƒ½æ€§',
                    challenge: 'å‹‡æ•¢é¢å¯¹ç”Ÿæ´»ä¸­çš„æŒ‘æˆ˜',
                    advice: 'æ¥å—å†…åœ¨æ™ºæ…§çš„æŒ‡å¼•',
                    outcome: 'ç›¸ä¿¡äº‹æƒ…ä¼šæœç€æœ€å¥½çš„æ–¹å‘å‘å±•',
                    self: 'äº†è§£è‡ªå·±å†…å¿ƒçš„çœŸå®æƒ³æ³•',
                    environment: 'æ³¨æ„å¤–éƒ¨ç¯å¢ƒçš„å½±å“å› ç´ ',
                    hopes: 'å¹³è¡¡å†…å¿ƒçš„å¸Œæœ›å’Œææƒ§'
                }
            };

            return contexts[questionType][positionId] || 'æ·±å…¥æ€è€ƒè¿™ä¸ªä½ç½®æ‰€ä»£è¡¨çš„æ„ä¹‰';
        }

        // ç”Ÿæˆä¸ªæ€§åŒ–è§£è¯»ï¼ˆçº¦100å­—ï¼‰
        function generatePersonalizedInterpretation(card, position, question, questionType, baseMeaning) {
            const keywords = card.isReversed ? card.reversed.keywords : card.upright.keywords;
            const cardName = card.name + (card.isReversed ? ' (é€†ä½)' : 'æ­£ä½)');
            const specificMeaning = card.isReversed ? card.reversed[questionType.id] || card.reversed.meaning : card.upright[questionType.id] || card.upright.meaning;

            // æ£€æŸ¥æ˜¯å¦ä¸ºè·³è¿‡æ¨¡å¼
            const isSkipMode = question === 'ç”¨æˆ·é€‰æ‹©è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥è¿›è¡Œå¡”ç½—ç‰Œæµ‹ç®—';

            // æ ¹æ®é—®é¢˜ç±»å‹å’Œä½ç½®ç”Ÿæˆæ·±åº¦ä¸ªæ€§åŒ–è§£è¯»
            let interpretation = '';

            if (isSkipMode) {
                // è·³è¿‡æ¨¡å¼ï¼šæä¾›é€šç”¨æŒ‡å¼•
                interpretation = generateSkipModeInterpretation(card, position, questionType, baseMeaning, specificMeaning, keywords);
            } else if (questionType.id === 'love') {
                interpretation = generateLoveInterpretation(card, position, question, baseMeaning, specificMeaning, keywords);
            } else if (questionType.id === 'career') {
                interpretation = generateCareerInterpretation(card, position, question, baseMeaning, specificMeaning, keywords);
            } else if (questionType.id === 'finance') {
                interpretation = generateFinanceInterpretation(card, position, question, baseMeaning, specificMeaning, keywords);
            } else if (questionType.id === 'health') {
                interpretation = generateHealthInterpretation(card, position, question, baseMeaning, specificMeaning, keywords);
            } else {
                interpretation = generateGeneralInterpretation(card, position, question, baseMeaning, specificMeaning, keywords);
            }

            return interpretation;
        }

        // æ„Ÿæƒ…è§£è¯»ç”Ÿæˆï¼ˆæ·±åº¦ç‰ˆï¼‰
        function generateLoveInterpretation(card, position, question, baseMeaning, specificMeaning, keywords) {
            const reversedText = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
            const positionContext = getPositionContext(position.id, 'love');

            let interpretation = `${position.name}ä½ç½®çš„${card.name}(${reversedText})æ·±åˆ»æ­ç¤ºäº†ä½ åœ¨æ„Ÿæƒ…å…³ç³»ä¸­çš„ç°çŠ¶ã€‚`;
            interpretation += `${specificMeaning}è¿™å¼ ç‰Œçš„æ ¸å¿ƒèƒ½é‡${keywords.join('ã€')}æé†’ä½ è¦${positionContext}ã€‚`;

            if (card.isReversed) {
                interpretation += `é€†ä½çš„å‡ºç°å¯èƒ½æš—ç¤ºç€æ„Ÿæƒ…ä¸­å­˜åœ¨ä¸€äº›é˜»ç¢æˆ–éœ€è¦åæ€çš„åœ°æ–¹ï¼Œå»ºè®®ä½ å®¡è§†è‡ªå·±å†…å¿ƒçœŸå®çš„æ¸´æœ›å’Œææƒ§ã€‚`;
            } else {
                interpretation += `æ­£ä½çš„èƒ½é‡æ”¯æŒä½ åœ¨æ„Ÿæƒ…é“è·¯ä¸Šç§¯æå‰è¡Œï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åˆ©äºæƒ…æ„Ÿå‘å±•çš„ä¿¡å·ã€‚`;
            }

            interpretation += `é’ˆå¯¹ä½ æåˆ°çš„"${question}"ï¼Œè¿™å¼ ç‰Œå»ºè®®ä½ è¦ç›¸ä¿¡å†…å¿ƒçš„æ„Ÿå—ï¼ŒåŒæ—¶ä¹Ÿè¦ä¿æŒç†æ€§å’Œæ™ºæ…§çš„å¹³è¡¡ã€‚`;

            return interpretation;
        }

        // äº‹ä¸šè§£è¯»ç”Ÿæˆï¼ˆæ·±åº¦ç‰ˆï¼‰
        function generateCareerInterpretation(card, position, question, baseMeaning, specificMeaning, keywords) {
            const reversedText = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
            const positionContext = getPositionContext(position.id, 'career');

            let interpretation = `${position.name}ä½ç½®çš„${card.name}(${reversedText})ä¸ºä½ çš„èŒä¸šå‘å±•æä¾›äº†é‡è¦æŒ‡å¼•ã€‚`;
            interpretation += `${specificMeaning}è¿™å¼ ç‰Œæ‰€ä½“ç°çš„${keywords.join('ã€')}èƒ½é‡ï¼Œæ­£åœ¨å½±å“ç€ä½ å½“å‰çš„å·¥ä½œçŠ¶æ€ã€‚`;

            if (card.isReversed) {
                interpretation += `é€†ä½æç¤ºå¯èƒ½å­˜åœ¨èŒä¸šå‘å±•ä¸Šçš„é˜»ç¢æˆ–å†…åœ¨çš„çŠ¹è±«ï¼Œéœ€è¦ä½ é‡æ–°è¯„ä¼°è‡ªå·±çš„èŒä¸šç›®æ ‡å’Œæ–¹å‘ã€‚`;
            } else {
                interpretation += `æ­£ä½çš„å‡ºç°æ˜¯ä¸€ä¸ªç§¯æçš„ä¿¡å·ï¼Œè¡¨æ˜ä½ çš„èŒä¸šé“è·¯ä¸Šæœ‰è‰¯å¥½çš„å‘å±•æœºä¼šå’Œæ”¯æŒã€‚`;
            }

            interpretation += `å…³äºä½ å…³å¿ƒçš„"${question}"ï¼Œè¿™å¼ ç‰Œå»ºè®®ä½ è¦${positionContext}ï¼Œç›¸ä¿¡è‡ªå·±çš„ä¸“ä¸šèƒ½åŠ›å’Œåˆ¤æ–­åŠ›ã€‚`;

            return interpretation;
        }

        // è´¢å¯Œè§£è¯»ç”Ÿæˆï¼ˆæ·±åº¦ç‰ˆï¼‰
        function generateFinanceInterpretation(card, position, question, baseMeaning, specificMeaning, keywords) {
            const reversedText = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
            const positionContext = getPositionContext(position.id, 'finance');

            let interpretation = `${position.name}ä½ç½®çš„${card.name}(${reversedText})æ·±å…¥åˆ†æäº†ä½ çš„è´¢åŠ¡çŠ¶å†µå’Œèƒ½é‡æµåŠ¨ã€‚`;
            interpretation += `${specificMeaning}è¿™å¼ ç‰Œçš„${keywords.join('ã€')}ç‰¹è´¨ï¼Œæ­£åœ¨å½±å“ç€ä½ å½“å‰çš„é‡‘é’±è§‚å¿µå’Œè¡Œä¸ºæ¨¡å¼ã€‚`;

            if (card.isReversed) {
                interpretation += `é€†ä½çš„å‡ºç°å¯èƒ½æš—ç¤ºç€è´¢åŠ¡ä¸Šçš„ä¸€äº›æŒ‘æˆ˜æˆ–éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œå»ºè®®ä½ æ›´åŠ è°¨æ…åœ°å¤„ç†é‡‘é’±äº‹åŠ¡ã€‚`;
            } else {
                interpretation += `æ­£ä½çš„èƒ½é‡æœ‰åˆ©äºè´¢åŠ¡çš„ç¨³å®šå’Œå¢é•¿ï¼Œè¿™æ˜¯ä¸€ä¸ªç§¯æçš„è´¢åŠ¡ç®¡ç†ä¿¡å·ã€‚`;
            }

            interpretation += `å¯¹äºä½ æå‡ºçš„"${question}"ï¼Œè¿™å¼ ç‰Œæé†’ä½ è¦${positionContext}ï¼Œå»ºç«‹å¥åº·çš„è´¢åŠ¡ä¹ æƒ¯å’Œé•¿è¿œè§„åˆ’ã€‚`;

            return interpretation;
        }

        // å¥åº·è§£è¯»ç”Ÿæˆï¼ˆæ·±åº¦ç‰ˆï¼‰
        function generateHealthInterpretation(card, position, question, baseMeaning, specificMeaning, keywords) {
            const reversedText = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
            const positionContext = getPositionContext(position.id, 'health');

            let interpretation = `${position.name}ä½ç½®çš„${card.name}(${reversedText})å…³æ³¨ç€ä½ çš„èº«å¿ƒæ•´ä½“å¥åº·çŠ¶å†µã€‚`;
            interpretation += `${specificMeaning}è¿™å¼ ç‰Œæ‰€ä»£è¡¨çš„${keywords.join('ã€')}èƒ½é‡ï¼Œæ­£åœ¨å½±å“ç€ä½ å½“å‰çš„èº«ä½“å’Œæƒ…ç»ªçŠ¶æ€ã€‚`;

            if (card.isReversed) {
                interpretation += `é€†ä½æç¤ºéœ€è¦ç‰¹åˆ«å…³æ³¨æŸäº›å¥åº·æ–¹é¢çš„ä¿¡å·ï¼Œå¯èƒ½å­˜åœ¨éœ€è¦åŠæ—¶è°ƒæ•´çš„ç”Ÿæ´»æ–¹å¼æˆ–æƒ…ç»ªé—®é¢˜ã€‚`;
            } else {
                interpretation += `æ­£ä½çš„å‡ºç°æ˜¯ä¸€ä¸ªç§¯æçš„å¥åº·ä¿¡å·ï¼Œè¡¨æ˜ä½ çš„æ•´ä½“èƒ½é‡çŠ¶å†µè‰¯å¥½ï¼Œæœ‰åˆ©äºèº«ä½“çš„æ¢å¤å’Œç»´æŒã€‚`;
            }

            interpretation += `å…³äºä½ å…³å¿ƒçš„å¥åº·é—®é¢˜"${question}"ï¼Œè¿™å¼ ç‰Œå»ºè®®ä½ è¦${positionContext}ï¼Œé‡è§†èº«ä½“å‘å‡ºçš„ä¿¡å·å¹¶åŠæ—¶é‡‡å–è¡ŒåŠ¨ã€‚`;

            return interpretation;
        }

        // é€šç”¨è§£è¯»ç”Ÿæˆï¼ˆæ·±åº¦ç‰ˆï¼‰
        function generateGeneralInterpretation(card, position, question, baseMeaning, specificMeaning, keywords) {
            const reversedText = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
            const positionContext = getPositionContext(position.id, 'general');

            let interpretation = `${position.name}ä½ç½®çš„${card.name}(${reversedText})ä¸ºä½ çš„é—®é¢˜"${question}"æä¾›äº†æ·±åˆ»çš„å¯ç¤ºã€‚`;
            interpretation += `${specificMeaning}è¿™å¼ ç‰Œçš„æ ¸å¿ƒå«ä¹‰${keywords.join('ã€')}æ­£åœ¨å½±å“ç€ä½ å½“å‰çš„ç”Ÿæ´»çŠ¶å†µå’Œå†³ç­–è¿‡ç¨‹ã€‚`;

            if (card.isReversed) {
                interpretation += `é€†ä½çš„å‡ºç°å¯èƒ½æš—ç¤ºç€æŸäº›å†…åœ¨çš„é˜»ç¢æˆ–éœ€è¦é‡æ–°è€ƒè™‘çš„æ–¹å‘ï¼Œé‚€è¯·ä½ æ·±å…¥åæ€é—®é¢˜çš„æ ¹æºã€‚`;
            } else {
                interpretation += `æ­£ä½çš„èƒ½é‡æ”¯æŒä½ ç§¯æé¢å¯¹å½“å‰çš„æŒ‘æˆ˜ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åˆ©äºè§£å†³é—®é¢˜å’Œå®ç°ç›®æ ‡çš„ä¿¡å·ã€‚`;
            }

            interpretation += `è¿™å¼ ç‰Œå»ºè®®ä½ è¦${positionContext}ï¼Œç›¸ä¿¡è‡ªå·±çš„å†…åœ¨æ™ºæ…§ï¼ŒåŒæ—¶ä¹Ÿè¦ä¿æŒå¼€æ”¾å’Œçµæ´»çš„å¿ƒæ€ã€‚`;

            return interpretation;
        }

        // è·³è¿‡æ¨¡å¼è§£è¯»ç”Ÿæˆï¼ˆé€šç”¨æŒ‡å¼•ï¼‰
        function generateSkipModeInterpretation(card, position, questionType, baseMeaning, specificMeaning, keywords) {
            const reversedText = card.isReversed ? 'é€†ä½' : 'æ­£ä½';
            const positionContext = getPositionContext(position.id, 'general');

            let interpretation = `${position.name}ä½ç½®çš„${card.name}(${reversedText})ä¸ºä½ çš„å¡”ç½—ç‰Œæµ‹ç®—æä¾›äº†é‡è¦å¯ç¤ºã€‚`;
            interpretation += `${specificMeaning}è¿™å¼ ç‰Œçš„æ ¸å¿ƒèƒ½é‡${keywords.join('ã€')}æ­£åœ¨å½±å“ç€ä½ å½“å‰çš„ç”Ÿæ´»çŠ¶æ€ã€‚`;

            if (card.isReversed) {
                interpretation += `é€†ä½çš„å‡ºç°æç¤ºç€æŸäº›æ–¹é¢éœ€è¦ç‰¹åˆ«å…³æ³¨ï¼Œè¿™å¯èƒ½æ˜¯å†…åœ¨æˆé•¿çš„æœºä¼šï¼Œæˆ–æ˜¯éœ€è¦é‡æ–°è¯„ä¼°çš„æ–¹å‘ã€‚é€†ä½å¹¶éå®Œå…¨è´Ÿé¢ï¼Œæ›´å¤šæ—¶å€™æ˜¯åœ¨é‚€è¯·æˆ‘ä»¬è¿›è¡Œæ·±å±‚çš„è‡ªæˆ‘åæ€ã€‚`;
            } else {
                interpretation += `æ­£ä½çš„èƒ½é‡æ”¯æŒä½ ç§¯æå‰è¡Œï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åˆ©äºå‘å±•å’Œçªç ´çš„ä¿¡å·ã€‚å½“å‰çš„ç¯å¢ƒå’Œæ¡ä»¶å¯¹ä½ çš„ç›®æ ‡å®ç°è¾ƒä¸ºæœ‰åˆ©ã€‚`;
            }

            interpretation += `åœ¨${questionType.name}æ–¹é¢ï¼Œè¿™å¼ ç‰Œå»ºè®®ä½ è¦${positionContext}ã€‚è®°ä½ï¼Œå¡”ç½—ç‰Œæä¾›çš„æ˜¯æŒ‡å¼•å’Œå¯ç¤ºï¼Œæœ€ç»ˆçš„é€‰æ‹©å’Œè¡ŒåŠ¨å§‹ç»ˆæŒæ¡åœ¨ä½ è‡ªå·±æ‰‹ä¸­ã€‚`;

            return interpretation;
        }

        // æ¸²æŸ“è§£è¯»ç»“æœ
        function renderReadingResults(results) {
            const container = document.getElementById('reading-results');
            container.innerHTML = '';

            results.forEach((result, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card';

                resultCard.innerHTML = `
                    <div class="result-position">${result.position.name} - ${result.position.meaning}</div>
                    <div class="result-card-info">
                        <div class="result-card-image">
                            ${result.card.name.charAt(0)}
                        </div>
                        <div class="result-card-details">
                            <h4>${result.card.name} ${result.card.isReversed ? '(é€†ä½)' : '(æ­£ä½)'}</h4>
                            <p>å…³é”®è¯ï¼š${result.card.isReversed ? result.card.reversed.keywords.join('ã€') : result.card.upright.keywords.join('ã€')}</p>
                        </div>
                    </div>
                    <div class="result-interpretation">
                        ${result.interpretation}
                    </div>
                `;

                container.appendChild(resultCard);
            });

            // ç”Ÿæˆæ•´ä½“åˆ†æ
            generateOverallAnalysis();
        }

        // ç”Ÿæˆæ•´ä½“åˆ†æï¼ˆçº¦300å­—æ·±åº¦ç‰ˆï¼‰
        function generateOverallAnalysis() {
            const container = document.getElementById('overall-analysis');

            const uprightCount = drawnCards.filter(card => !card.isReversed).length;
            const reversedCount = drawnCards.filter(card => card.isReversed).length;
            const totalCards = drawnCards.length;

            // æ£€æŸ¥æ˜¯å¦ä¸ºè·³è¿‡æ¨¡å¼
            const isSkipMode = userQuestion === 'ç”¨æˆ·é€‰æ‹©è·³è¿‡é—®é¢˜å¡«å†™ï¼Œç›´æ¥è¿›è¡Œå¡”ç½—ç‰Œæµ‹ç®—';

            // æ·±åº¦åˆ†æç‰Œé˜µèƒ½é‡å’Œæ¨¡å¼
            let analysis = `<h3>${isSkipMode ? 'é€šç”¨å¡”ç½—ç‰ŒæŒ‡å¼•ä¸å»ºè®®' : 'æ·±åº¦æ•´ä½“åˆ†æä¸ä¸“ä¸šå»ºè®®'}</h3>`;

            // èƒ½é‡åˆ†æéƒ¨åˆ†
            analysis += `<p><strong>ğŸ”® ç‰Œé˜µèƒ½é‡æ·±åº¦è§£æï¼š</strong>æœ¬æ¬¡${currentSpread.name}æµ‹ç®—ä¸­å…±æ˜¾ç° ${totalCards} å¼ å¡ç‰Œï¼Œå…¶ä¸­æ­£ä½ç‰Œ ${uprightCount} å¼ ï¼Œé€†ä½ç‰Œ ${reversedCount} å¼ ã€‚`;

            if (uprightCount > reversedCount * 2) {
                analysis += `è¿™ç§å¼ºçƒˆçš„æ­£ä½èƒ½é‡è¡¨æ˜ä½ å½“å‰çš„ç”Ÿæ´»çŠ¶æ€ç›¸å¯¹é¡ºç•…ï¼Œäº‹æƒ…å‘å±•å…·æœ‰è‰¯å¥½çš„åŠ¿å¤´ã€‚ç„¶è€Œï¼Œä¹Ÿè¦è­¦æƒ•è¿‡åº¦ä¹è§‚å¯èƒ½å¸¦æ¥çš„ç–å¿½ï¼Œå»ºè®®åœ¨ç§¯æå‰è¡Œçš„åŒæ—¶ä¿æŒé€‚åº¦çš„è°¨æ…ã€‚`;
            } else if (reversedCount > uprightCount * 2) {
                analysis += `è¾ƒå¤šçš„é€†ä½ç‰Œæç¤ºç€æŸäº›æ–¹é¢éœ€è¦ç‰¹åˆ«å…³æ³¨ã€‚è¿™å¯èƒ½æ„å‘³ç€å†…åœ¨çš„æˆé•¿å¥‘æœºï¼Œæˆ–è€…æ˜¯éœ€è¦é‡æ–°è¯„ä¼°çš„æ–¹å‘ã€‚é€†ä½å¹¶éå®Œå…¨æ˜¯è´Ÿé¢çš„ï¼Œæ›´å¤šæ—¶å€™æ˜¯åœ¨é‚€è¯·æˆ‘ä»¬è¿›è¡Œæ·±å±‚çš„è‡ªæˆ‘åæ€å’Œè°ƒæ•´ã€‚`;
            } else if (uprightCount === reversedCount) {
                analysis += `å®Œç¾çš„æ­£é€†å¹³è¡¡æ˜¾ç¤ºç€ä½ å½“å‰å¤„äºä¸€ä¸ªé‡è¦çš„è½¬æŠ˜ç‚¹ï¼Œè¿™ç§å¹³è¡¡èƒ½é‡æ—¢æ˜¯æŒ‘æˆ˜ä¹Ÿæ˜¯æœºé‡ã€‚éœ€è¦ä½ ç”¨æ™ºæ…§å’Œè€å¿ƒæ¥æŠŠæ¡è¿™ä¸ªå¾®å¦™çš„å¹³è¡¡çŠ¶æ€ã€‚`;
            } else {
                analysis += `æ•´ä½“èƒ½é‡å¤„äºåŠ¨æ€å¹³è¡¡ä¸­ï¼Œæ—¢æœ‰é¡ºç•…å‘å±•çš„æ–¹é¢ï¼Œä¹Ÿæœ‰éœ€è¦ç‰¹åˆ«å…³æ³¨çš„é¢†åŸŸã€‚è¿™ç§çŠ¶å†µæé†’æˆ‘ä»¬è¦å…¨é¢çœ‹å¾…é—®é¢˜ï¼Œæ—¢è¦æŠ“ä½æœºä¼šï¼Œä¹Ÿè¦è°¨æ…åº”å¯¹æŒ‘æˆ˜ã€‚`;
            }
            analysis += `</p>`;

            // é’ˆå¯¹å…·ä½“é—®é¢˜çš„æ·±åº¦åˆ†æ
            if (isSkipMode) {
                analysis += `<p><strong>ğŸ’« é€šç”¨å¡”ç½—ç‰ŒæŒ‡å¼•ï¼š</strong>`;
                analysis += `ç”±äºä½ é€‰æ‹©äº†å¿«é€Ÿæµ‹ç®—æ¨¡å¼ï¼Œæœ¬æ¬¡å¡”ç½—ç‰Œå°†ä¸ºä½ æä¾›é€šç”¨çš„ç”Ÿæ´»æŒ‡å¼•å’Œæ™ºæ…§å¯ç¤ºã€‚`;
                analysis += `åœ¨${selectedQuestionType.name}æ–¹é¢ï¼Œç‰Œé˜µæ­ç¤ºäº†å½“å‰èƒ½é‡çŠ¶æ€å’Œå¯èƒ½çš„å‘å±•è¶‹åŠ¿ã€‚æ¯å¼ ç‰Œéƒ½åœ¨è¯‰è¯´ç€ä¸åŒçš„ç”Ÿæ´»é¢å‘ï¼Œä»å†…åœ¨çš„å¿ƒæ€åˆ°å¤–åœ¨çš„ç¯å¢ƒï¼Œä»æŒ‘æˆ˜åˆ°æœºé‡ã€‚`;
                analysis += `å¡”ç½—ç‰Œæé†’æˆ‘ä»¬ï¼šç”Ÿæ´»ä¸­çš„æ¯ä¸ªç»å†éƒ½æœ‰å…¶æ„ä¹‰å’Œä»·å€¼ï¼Œæ— è®ºæ˜¯é¡ºå¢ƒè¿˜æ˜¯é€†å¢ƒã€‚é‡è¦çš„æ˜¯ä¿æŒè§‰å¯Ÿå’Œå­¦ä¹ çš„æ€åº¦ï¼Œç›¸ä¿¡è‡ªå·±çš„å†…åœ¨æ™ºæ…§ã€‚`;
                analysis += `</p>`;
            } else {
                analysis += `<p><strong>ğŸ’« é’ˆå¯¹\"${userQuestion}\"çš„ä¸“ä¸šæŒ‡å¼•ï¼š</strong>`;

                if (selectedQuestionType.id === 'love') {
                    analysis += `åœ¨æ„Ÿæƒ…å…³ç³»æ–¹é¢ï¼Œæœ¬æ¬¡ç‰Œé˜µæ­ç¤ºäº†æƒ…æ„Ÿå‘å±•çš„å¤æ‚æ€§å’Œå¤šå±‚æ¬¡æ€§ã€‚æ¯å¼ ç‰Œéƒ½åœ¨è¯‰è¯´ç€å…³ç³»ä¸­çš„ä¸åŒé¢å‘ï¼šæœ‰çš„æŒ‡å‘è¿‡å»çš„æƒ…æ„Ÿæ¨¡å¼ï¼Œæœ‰çš„åæ˜ å½“å‰çš„çœŸå®çŠ¶å†µï¼Œè¿˜æœ‰çš„é¢„ç¤ºç€æœªæ¥çš„å‘å±•è¶‹åŠ¿ã€‚`;
                    analysis += `å¡”ç½—ç‰Œå»ºè®®ä½ è¦å»ºç«‹çœŸå®è€Œæ·±åˆ»çš„æƒ…æ„Ÿè¿æ¥ï¼Œè¿™ä¸ä»…åŒ…æ‹¬ä¸ä»–äººçš„å…³ç³»ï¼Œæ›´é‡è¦çš„æ˜¯ä¸è‡ªå·±å†…å¿ƒçš„å’Œè°ã€‚å­¦ä¼šåœ¨ç»™äºˆå’Œæ¥å—ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ï¼Œåœ¨äº²å¯†å’Œç‹¬ç«‹ä¹‹é—´ç»´æŒå¥åº·çš„ç•Œé™ã€‚`;
                    analysis += `æ— è®ºæ˜¯å•èº«è¿˜æ˜¯åœ¨å…³ç³»ä¸­ï¼Œéƒ½è¦è®°ä½ï¼šçœŸæ­£çš„çˆ±æƒ…å§‹äºè‡ªçˆ±ï¼Œåªæœ‰åœ¨äº†è§£å¹¶æ¥çº³è‡ªå·±çš„åŸºç¡€ä¸Šï¼Œæ‰èƒ½å»ºç«‹å¥åº·æŒä¹…çš„ä¼´ä¾£å…³ç³»ã€‚`;
                } else if (selectedQuestionType.id === 'career') {
                    analysis += `èŒä¸šå‘å±•æ–¹é¢ï¼Œç‰Œé˜µå±•ç°äº†å½“å‰å·¥ä½œçŠ¶å†µçš„å¤šç»´åº¦å›¾æ™¯ã€‚ä»ä¸“ä¸šæŠ€èƒ½çš„åº”ç”¨åˆ°å·¥ä½œç¯å¢ƒçš„å½±å“ï¼Œä»ä¸ªäººä»·å€¼å®ç°åˆ°å›¢é˜Ÿåä½œçš„é‡è¦æ€§ï¼Œæ¯ä¸€å¼ ç‰Œéƒ½åœ¨ä¸ºä½ æä¾›èŒä¸šå‘å±•çš„å…³é”®æŒ‡å¼•ã€‚`;
                    analysis += `è¿™æ˜¯ä¸€ä¸ªéœ€è¦åŒæ—¶å…·å¤‡è¡ŒåŠ¨åŠ›å’Œè€å¿ƒçš„æ—¶æœŸã€‚ç›¸ä¿¡è‡ªå·±çš„ä¸“ä¸šèƒ½åŠ›å’Œåˆ¤æ–­åŠ›ï¼ŒåŒæ—¶ä¹Ÿè¦ä¿æŒå¼€æ”¾å­¦ä¹ çš„å¿ƒæ€ã€‚èŒä¸šé“è·¯å¾€å¾€ä¸æ˜¯ç›´çº¿ä¸Šå‡çš„ï¼Œè€Œæ˜¯å……æ»¡äº†è½¬æŠ˜å’Œå­¦ä¹ çš„æœºä¼šã€‚`;
                    analysis += `å»ºè®®ä½ é‡æ–°å®¡è§†è‡ªå·±çš„èŒä¸šç›®æ ‡å’Œä»·å€¼è§‚ï¼Œç¡®ä¿å½“å‰çš„å·¥ä½œæ–¹å‘ä¸å†…å¿ƒçš„çœŸå®æœŸæœ›ç›¸ç¬¦ã€‚æœ‰æ—¶å€™ï¼Œæš‚æ—¶çš„è°ƒæ•´å¯èƒ½ä¼šä¸ºé•¿è¿œçš„å‘å±•å¥ å®šæ›´åšå®çš„åŸºç¡€ã€‚`;
                } else if (selectedQuestionType.id === 'finance') {
                    analysis += `è´¢åŠ¡çŠ¶å†µçš„åˆ†ææ˜¾ç¤ºé‡‘é’±èƒ½é‡åœ¨ä½ ç”Ÿæ´»ä¸­çš„æµåŠ¨æ¨¡å¼ã€‚ä»æ”¶å…¥æ¥æºçš„ç¨³å®šæ€§åˆ°æ”¯å‡ºç»“æ„çš„åˆç†æ€§ï¼Œä»æŠ•èµ„æœºä¼šçš„æŠŠæ¡åˆ°é£é™©ç®¡ç†çš„å¿…è¦æ€§ï¼Œç‰Œé˜µä¸ºä½ æä¾›äº†å…¨é¢çš„è´¢åŠ¡å¥åº·æ£€æŸ¥ã€‚`;
                    analysis += `åœ¨é‡‘é’±ç®¡ç†æ–¹é¢ï¼Œéœ€è¦å¹³è¡¡å¥½çŸ­æœŸéœ€æ±‚å’Œé•¿æœŸè§„åˆ’ï¼Œå¤„ç†å¥½é£é™©æ§åˆ¶ä¸æ”¶ç›Šå¢é•¿çš„å…³ç³»ã€‚é¿å…æƒ…ç»ªåŒ–çš„è´¢åŠ¡å†³ç­–ï¼Œå»ºç«‹åŸºäºç†æ€§å’Œä¸“ä¸šçŸ¥è¯†çš„æŠ•èµ„ç­–ç•¥ã€‚`;
                    analysis += `è®°ä½ï¼Œè´¢åŠ¡å®‰å…¨ä¸ä»…ä»…æ˜¯æ•°å­—çš„æ¸¸æˆï¼Œæ›´æ˜¯å†…å¿ƒå®‰å…¨æ„Ÿçš„ä½“ç°ã€‚å»ºç«‹å¥åº·çš„é‡‘é’±è§‚å¿µï¼Œè®©è´¢å¯Œæˆä¸ºå®ç°äººç”Ÿç›®æ ‡çš„å·¥å…·ï¼Œè€Œä¸æ˜¯è¡¡é‡è‡ªæˆ‘ä»·å€¼çš„å”¯ä¸€æ ‡å‡†ã€‚`;
                } else if (selectedQuestionType.id === 'health') {
                    analysis += `å¥åº·çŠ¶å†µçš„åˆ†ææ¶µç›–äº†èº«ä½“ã€æƒ…ç»ªã€ç²¾ç¥å’Œå¿ƒçµçš„å„ä¸ªå±‚é¢ã€‚å¡”ç½—ç‰Œæé†’æˆ‘ä»¬ï¼šçœŸæ­£çš„å¥åº·æ˜¯èº«å¿ƒçµçš„å’Œè°ç»Ÿä¸€ï¼Œä»»ä½•ä¸€ä¸ªå±‚é¢çš„å¤±è¡¡éƒ½å¯èƒ½å½±å“åˆ°æ•´ä½“çš„ç¦ç¥‰ã€‚`;
                    analysis += `å»ºè®®ä½ å…³æ³¨èº«ä½“å‘å‡ºçš„ä¿¡å·ï¼Œå»ºç«‹è‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼ŒåŒ…æ‹¬è§„å¾‹çš„ä½œæ¯ã€å‡è¡¡çš„é¥®é£Ÿã€é€‚åº¦çš„è¿åŠ¨ã€‚åŒæ—¶ï¼Œä¹Ÿè¦é‡è§†æƒ…ç»ªçš„ç®¡ç†å’Œå‹åŠ›çš„é‡Šæ”¾ï¼Œå­¦ä¼šé€šè¿‡å¥åº·çš„æ–¹å¼æ¥è¡¨è¾¾å’Œå¤„ç†æƒ…æ„Ÿã€‚`;
                    analysis += `é¢„é˜²èƒœäºæ²»ç–—ï¼Œå®šæœŸçš„å¥åº·æ£€æŸ¥å’Œè‡ªæˆ‘ä¿å¥æ„è¯†çš„åŸ¹å…»ï¼Œæ˜¯ç»´æŒé•¿æœŸå¥åº·çš„å…³é”®ã€‚è®°ä½ï¼Œèº«ä½“æ˜¯æˆ‘ä»¬çµé­‚çš„æ®¿å ‚ï¼Œå€¼å¾—æˆ‘ä»¬ç”¨å¿ƒå»å‘µæŠ¤å’Œçæƒœã€‚`;
                } else {
                    analysis += `é’ˆå¯¹ä½ æå‡ºçš„\"${userQuestion}\"ï¼Œå¡”ç½—ç‰Œæä¾›äº†å¤šç»´åº¦çš„åˆ†æå’Œå»ºè®®ã€‚è¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°ä½ ç”Ÿæ´»ä¸­çš„é‡è¦æ–¹é¢ï¼Œéœ€è¦ä»å¤šä¸ªè§’åº¦æ¥æ€è€ƒå’Œçœ‹å¾…ã€‚`;
                    analysis += `ç‰Œé˜µæ˜¾ç¤ºå½“å‰çš„çŠ¶å†µæ—¢æœ‰æœ‰åˆ©å› ç´ ï¼Œä¹Ÿå­˜åœ¨éœ€è¦å…³æ³¨çš„æŒ‘æˆ˜ã€‚é‡è¦çš„æ˜¯è¦ä¿æŒå†…å¿ƒçš„å¹³é™å’Œæ¸…æ™°çš„æ€ç»´ï¼Œæ—¢ä¸è¢«å›°éš¾æ‰€å“å€’ï¼Œä¹Ÿä¸è¢«è¡¨é¢çš„é¡ºåˆ©æ‰€è¿·æƒ‘ã€‚`;
                    analysis += `ç›¸ä¿¡è‡ªå·±çš„ç›´è§‰å’Œåˆ¤æ–­åŠ›ï¼ŒåŒæ—¶ä¹Ÿè¦ä¿æŒå¼€æ”¾å’Œå­¦ä¹ çš„å¿ƒæ€ã€‚æœ‰æ—¶å€™ï¼Œç­”æ¡ˆå°±åœ¨æˆ‘ä»¬å†…å¿ƒæ·±å¤„ï¼Œéœ€è¦çš„åªæ˜¯é™å¿ƒè†å¬å’Œå‹‡æ•¢è¡ŒåŠ¨ã€‚`;
                }
                analysis += `</p>`;
            }

            // ç‰Œé˜µç‰¹è‰²åˆ†æ
            analysis += `<p><strong>ğŸŒŸ ${currentSpread.name}ç‰¹è‰²è§£è¯»ï¼š</strong>`;
            analysis += `ä½ é€‰æ‹©çš„${currentSpread.name}å…·æœ‰ç‹¬ç‰¹çš„è§£è¯»è§†è§’ã€‚è¿™ç§ç‰Œé˜µç‰¹åˆ«æ“…é•¿æ­ç¤º`;

            if (currentSpread.id === 'celtic-cross') {
                analysis += `é—®é¢˜çš„å¤æ‚æ€§å’Œå¤šå±‚é¢å½±å“ï¼Œä»æ ¸å¿ƒçŠ¶å†µåˆ°æœ€ç»ˆç»“æœï¼Œä¸ºä½ æä¾›å…¨é¢çš„åˆ†ææ¡†æ¶ã€‚`;
            } else if (currentSpread.id === 'relationship') {
                analysis += `å…³ç³»åŒæ–¹çš„åŠ¨æ€äº’åŠ¨å’Œèƒ½é‡äº¤æµï¼Œå¸®åŠ©ä½ ç†è§£å…³ç³»ä¸­çš„æ·±å±‚æ¬¡æ¨¡å¼å’Œæ½œåœ¨å‘å±•ã€‚`;
            } else if (currentSpread.id === 'horseshoe') {
                analysis += `äº‹ä»¶å‘å±•çš„æ—¶é—´è„‰ç»œå’Œå…³é”®è½¬æŠ˜ç‚¹ï¼Œè®©ä½ æ¸…æ¥šçœ‹åˆ°ä»è¿‡å»åˆ°æœªæ¥çš„å‘å±•è½¨è¿¹ã€‚`;
            } else if (currentSpread.id === 'three-card') {
                analysis += `é—®é¢˜çš„æ—¶é—´ç»´åº¦å‘å±•ï¼Œé€šè¿‡è¿‡å»-ç°åœ¨-æœªæ¥çš„æ¡†æ¶ä¸ºä½ æä¾›æ¸…æ™°çš„æ—¶é—´çº¿æŒ‡å¼•ã€‚`;
            } else {
                analysis += `é—®é¢˜çš„æ ¸å¿ƒæœ¬è´¨å’Œç›´æ¥ç­”æ¡ˆï¼Œæä¾›ç®€æ´è€Œæœ‰åŠ›çš„æŒ‡å¼•æ–¹å‘ã€‚`;
            }
            analysis += `</p>`;

            // ç»¼åˆè¡ŒåŠ¨å»ºè®®
            analysis += `<p><strong>ğŸ¯ ä¸“ä¸šè¡ŒåŠ¨å»ºè®®ï¼š</strong>åŸºäºæœ¬æ¬¡å¡”ç½—ç‰Œæ·±åº¦åˆ†æï¼Œå»ºè®®ä½ åœ¨æ¥ä¸‹æ¥çš„28å¤©å‘¨æœŸå†…é‡‡å–ä»¥ä¸‹å…·ä½“è¡ŒåŠ¨ï¼š`;
            analysis += `é¦–å…ˆï¼Œä¿æŒæ¯æ—¥çš„è‡ªæˆ‘è§‰å¯Ÿå’Œåæ€ï¼Œè®°å½•é‡è¦çš„ç›´è§‰å’Œæ´å¯Ÿã€‚å…¶æ¬¡ï¼Œæ ¹æ®ç‰Œé˜µæŒ‡å¼•ï¼Œé€æ­¥è°ƒæ•´ä¸${selectedQuestionType.name}ç›¸å…³çš„æ€ç»´æ¨¡å¼å’Œè¡Œä¸ºæ–¹å¼ã€‚`;
            analysis += `æœ€é‡è¦çš„æ˜¯ï¼Œè¦è®°ä½å¡”ç½—ç‰Œæä¾›çš„æ˜¯å‚è€ƒå’Œå¯ç¤ºï¼Œæœ€ç»ˆçš„é€‰æ‹©å’Œè¡ŒåŠ¨å§‹ç»ˆæŒæ¡åœ¨ä½ è‡ªå·±æ‰‹ä¸­ã€‚ç›¸ä¿¡å†…å¿ƒçš„æ™ºæ…§ï¼Œå‹‡æ•¢åœ°æœç€è‡ªå·±è®¤ä¸ºæ­£ç¡®çš„æ–¹å‘å‰è¿›ï¼ŒåŒæ—¶ä¿æŒå¯¹å˜åŒ–çš„é€‚åº”æ€§å’Œå¼€æ”¾æ€§ã€‚`;
            analysis += `</p>`;

            // ç¥ç¦è¯­
            analysis += `<p><strong>âœ¨ æ·±åº¦ç¥ç¦ï¼š</strong>æ„¿ä½ åœ¨${selectedQuestionType.name}çš„æ¢ç´¢æ—…ç¨‹ä¸­æ‰¾åˆ°æ·±å±‚çš„ç­”æ¡ˆå’Œæ–¹å‘ï¼Œæ„¿å¡”ç½—ç‰Œçš„å¤è€æ™ºæ…§èƒ½å¤Ÿä¸ºä½ ç…§äº®å‰è¡Œçš„é“è·¯ã€‚`;
            analysis += `è®°ä½ï¼Œæ¯ä¸€æ¬¡æµ‹ç®—éƒ½æ˜¯ä¸æ›´é«˜æ™ºæ…§çš„å¯¹è¯ï¼Œæ¯ä¸€æ¬¡é€‰æ‹©éƒ½æ˜¯åˆ›é€ ç¾å¥½æœªæ¥çš„æœºä¼šã€‚ç›¸ä¿¡è‡ªå·±ï¼Œä½ æ‹¥æœ‰é¢å¯¹ä¸€åˆ‡æŒ‘æˆ˜çš„å†…åœ¨åŠ›é‡å’Œæ™ºæ…§ã€‚`;
            analysis += `</p>`;

            container.innerHTML = analysis;
        }

        // é¡µé¢åˆ‡æ¢
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        // é‡æ–°æµ‹ç®—
        function newReading() {
            selectedQuestionType = null;
            userQuestion = '';
            currentSpread = null;
            drawnCards = [];
            currentCardIndex = 0;

            document.getElementById('user-question').value = '';
            document.getElementById('draw-card-btn').style.display = 'inline-block';
            document.getElementById('complete-reading-btn').style.display = 'none';

            showPage('question-type-page');
        }

        // åˆ†äº«ç»“æœï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
        function shareReading() {
            const shareText = `æˆ‘åˆšåˆšè¿›è¡Œäº†å¡”ç½—ç‰Œæµ‹ç®—ï¼Œå’¨è¯¢çš„æ˜¯${selectedQuestionType.name}æ–¹é¢çš„é—®é¢˜ï¼š${userQuestion}`;

            if (navigator.share) {
                navigator.share({
                    title: 'æˆ‘çš„å¡”ç½—ç‰Œæµ‹ç®—ç»“æœ',
                    text: shareText
                });
            } else {
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('æµ‹ç®—ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initializePage);

        // å¤‡ç”¨åˆå§‹åŒ–æ–¹æ³•
        window.addEventListener('load', function() {
            console.log('Window load event fired');
            setTimeout(() => {
                if (!window.tarotData || !window.tarotData.questionCategories) {
                    console.error('æ•°æ®ä»æœªåŠ è½½ï¼Œå°è¯•é‡æ–°åˆå§‹åŒ–');
                    initializePage();
                }
            }, 500);
        });

        // é¢å¤–çš„å®‰å…¨ç½‘ï¼šç¡®ä¿è„šæœ¬æ ‡ç­¾åŠ è½½å®Œæˆåè§¦å‘
        document.addEventListener('load', function(e) {
            if (e.target.tagName === 'SCRIPT' && e.target.textContent.includes('å¡”ç½—ç‰Œæ•°æ®ç»“æ„')) {
                console.log('å¡”ç½—ç‰Œæ•°æ®è„šæœ¬åŠ è½½å®Œæˆ');
                setTimeout(initializePage, 100);
            }
        }, true);
    </script>
</body>
</html>